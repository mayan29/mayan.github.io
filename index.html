<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="mayan`s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="mayan`s blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mayan`s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>mayan`s blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mayan`s blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/19/【iOS】每日一道面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mayan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mayan`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/19/【iOS】每日一道面试题/" itemprop="url">【iOS】每日一道面试题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-19T10:21:55+08:00">
                2018-06-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/06/19/【iOS】每日一道面试题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2018/06/19/【iOS】每日一道面试题/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>坚持每日记录一道面试题，持续更新。★ 为超级简单题目，★★ 为简单题目，以此类推，满级 ★★★★★ 五星。</p>
<h1 id="C-Objective-C"><a href="#C-Objective-C" class="headerlink" title="C / Objective-C"></a>C / Objective-C</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><strong>题目：把 “<a href="http://www.zhidao.baidu.com&quot;" target="_blank" rel="noopener">www.zhidao.baidu.com&quot;</a> 字符串改成 “com/baidu/zhidao/www”。</strong><br><strong>星级：★</strong>  </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *str = <span class="string">@"www.zhidao.baidu.com"</span>;</span><br><span class="line"><span class="built_in">NSArray</span> *tmpArray = [str componentsSeparatedByString:<span class="string">@"."</span>];</span><br><span class="line">tmpArray = [[tmpArray reverseObjectEnumerator] allObjects];  <span class="comment">// 数组倒叙排列</span></span><br><span class="line"><span class="built_in">NSString</span> *resultStr = [tmpArray componentsJoinedByString:<span class="string">@"/"</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, resultStr);</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com/baidu/zhidao/www</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其实这道题一点难点都没有，唯一需要注意的是要熟记这三个方法的方法名。</p>
<p>components - n. 组件<br>separated - adj. 分离的<br>reverse - v. 反转，颠倒<br>enumerator - n. 枚举器</p>
</blockquote>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><strong>题目：不用临时变量怎么实现 swap(a, b) ？</strong><br><strong>星级：★</strong>  </p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">20</span>;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"a = %d, b = %d"</span>, a, b);  </span><br><span class="line"></span><br><span class="line">a = a ^ b;</span><br><span class="line">b = a ^ b;</span><br><span class="line">a = a ^ b;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"a = %d, b = %d"</span>, a, b);</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">10</span>, b = <span class="number">20</span></span><br><span class="line">a = <span class="number">20</span>, b = <span class="number">10</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>用加法或者异或都可以，我比较偏好于异或，因为如果使用加法，两个数值太大的情况下，容易超出 int 范围。</p>
</blockquote>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p><strong>题目：下面这段代码的输出结果是？</strong><br><strong>星级：★★</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[<span class="number">5</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> *ptr = (<span class="keyword">int</span> *)(&amp;a + <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d, %d"</span>, *(a + <span class="number">1</span>), *(ptr - <span class="number">1</span>));</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>, <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>a 是指向数组开头元素的指针，a + 1 就是指向下一个元素的指针，所以星号求值以后是 2。&amp;a 相当于是数组的指针，&amp;a + 1 是数组后面一个数组的指针，然后转换成 int * 类型是 5 这个数字后面的一个数字的指针。再减一就是指向 5 的指针，所以星号求值以后是 5。</p>
<h1 id="UIKit"><a href="#UIKit" class="headerlink" title="UIKit"></a>UIKit</h1><h1 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h1><h2 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h2><p><strong>题目：OC 中 load 和 initialize 方法有何异同？</strong><br><strong>星级：★★</strong></p>
<p>相同点：</p>
<ol>
<li>load 和 initialize 方法都会在实例化对象之前调用，main 函数之前调用 load，之后调用 initialize；</li>
<li>load 和 initialize 方法都只会调用一次；</li>
<li>load 和 initialize 方法都会被自动调用，不能手动调用它们；</li>
<li>load 和 initialize 方法调用，会从父到子依次实现父类们的 load 和 initialize 方法；</li>
<li>load 和 initialize 方法内部为了保证线程安全都使用了锁，实现时要保持逻辑简单，避免阻塞线程；</li>
</ol>
<p>不同点：</p>
<ol>
<li>load 方法通常用来进行 Method Swizzle，initialize 方法通常用于初始化全局变量或者静态变量。</li>
<li>load 方法在类被程序装载时调用，与这个类是否被用到无关，initialize 方法是在类或者它的子类接收第一条消息前被调用。如果该类一直没有被用到，它的 initialize 方法也不会调用。</li>
</ol>
<p>其他：</p>
<ol>
<li>load 方法调用顺序永远都是：parent &gt; child &gt; child+extend ；</li>
<li>当有 child+extend 存在的时候，child+extend 中的 initialize 方法会覆盖 child 中的 initialize 方法。</li>
</ol>
<p>具体分析和实例参考：<a href="https://bestswifter.com/load-and-initialize/" target="_blank" rel="noopener">细说 OC 中的 load 和 initialize 方法</a></p>
<h1 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h1><h1 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h1><h1 id="待总结题目"><a href="#待总结题目" class="headerlink" title="待总结题目"></a>待总结题目</h1><h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h3><ol>
<li>说说你对 block 的理解。 —— 三种 block，栈上的 block 在 ARC 下会自动复制到堆上，block 的属性修饰符是 copy，循环引用的原理和解决方案。</li>
<li>block 为什么会有循环引用</li>
<li>说说你对 runtime 的理解。 —— 主要是方法调用时如何查找缓存，如何找到方法，找不到方法时怎么转发，对象的内存布局。</li>
<li>说说你对 MVC、MVVM 和 RAC 的理解。 —— MVC 的 C 太臃肿，可以和 V 合并，变成 MVVM 中的 V，而 VM 用来将 M 转化成 V 能用的数据。RAC 数据的双向绑定怎么做，bind 函数了解过么。</li>
<li>MVC 具有什么样的优势，各个模块之间怎么通信，比如点击 Button 后 怎么通知 Model？</li>
<li>说说 UITableView 的调优。 —— 一方面是通过 instruments 检查影响性能的地方，另一方面是估算高度并在 runloop 空闲时缓存。</li>
<li>谈谈你对 ARC 的理解。 —— ARC 是编译器完成的，依靠引用计数，谈谈几个属性修饰符的内存管理策略，什么情况下会内存泄露。</li>
<li>野指针是什么，iOS 开发中什么情况下会有野指针？ —— 野指针是不为 nil，但是指向已经被释放的内存的指针。</li>
<li>介绍自己用过哪些开源库。 —— Masonry 和 SnapKit，AFNetWorking，MKNetworkKit，Alamofire，Mantle，SDWebImage</li>
<li>SDWebImage 下载了图片后为什么要解码？ —— 要把 png 文件建立一个内存映射。</li>
<li>两个无限长度链表（也就是可能有环） 判断有没有交点</li>
<li>KVO、Notification、delegate 各自的优缺点，效率还有使用场景</li>
<li>如何手动通知 KVO</li>
<li>Objective-C 中的 copy 方法</li>
<li>runtime 中，SEL 和 IMP 的区别</li>
<li>autoreleasepool 的使用场景和原理</li>
<li>RunLoop 的实现原理和数据结构，什么时候会用到</li>
<li>使用 GCD 如何实现这个需求：A、B、C 三个任务并发，完成后执行任务 D。</li>
<li>NSOperation 和 GCD 的区别</li>
<li>CoreData 的使用，如何处理多线程问题</li>
<li>如何设计图片缓存？</li>
<li>有没有自己设计过网络控件？</li>
<li>怎么判断某个 cell 是否显示在屏幕上</li>
<li>进程和线程的区别</li>
<li>TCP 与 UDP 区别</li>
<li>TCP 流量控制</li>
<li>数组和链表的区别</li>
<li>UIView 生命周期</li>
<li>如果页面 A 跳转到 页面 B，A 的 viewDidDisappear 方法和 B 的 viewDidAppear 方法哪个先调用？</li>
<li>ARC 的本质</li>
<li>RunLoop 的基本概念，它是怎么休眠的？</li>
<li>Autoreleasepool 什么时候释放，在什么场景下使用？</li>
<li>如何找到字符串中第一个不重复的字符</li>
<li>哈希表如何处理冲突</li>
</ol>
<h3 id="算法-1"><a href="#算法-1" class="headerlink" title="算法"></a>算法</h3><p>算法主要分为以下几个部分：字符串、数组与查找、链表、树以及其他基础问题。</p>
<p>再详细总结一下，比如递归、动态规划、BFS/DFS、双指针、二分搜索等。或者是直接考察数据结构的使用，如：哈希、栈和队列、链表等。</p>
<p>将阅读《剑指 Offer》列入今年的学习计划中。</p>
<p>列出的一些经典题目，在“【】”中标记了我对此题类型的分类，如果加星号表示此题在实际面试中出现过：</p>
<p>字符串</p>
<ul>
<li>【3】最长回文子串（<a href="https://leetcode.com/problems/longest-palindromic-substring/）" target="_blank" rel="noopener">https://leetcode.com/problems/longest-palindromic-substring/）</a></li>
<li>【3】最长无重复子串（<a href="https://leetcode.com/problems/longest-substring-without-repeating-characters/）" target="_blank" rel="noopener">https://leetcode.com/problems/longest-substring-without-repeating-characters/）</a></li>
<li>【1*】字符串转数字（<a href="https://leetcode.com/problems/string-to-integer-atoi/）" target="_blank" rel="noopener">https://leetcode.com/problems/string-to-integer-atoi/）</a></li>
<li>【4】KMP 算法</li>
<li>【2】字符串全排列（<a href="http://blog.csdn.net/morewindows/article/details/7370155）" target="_blank" rel="noopener">http://blog.csdn.net/morewindows/article/details/7370155）</a></li>
<li>【2*】翻转字符串（<a href="https://leetcode.com/problems/reverse-words-in-a-string/）" target="_blank" rel="noopener">https://leetcode.com/problems/reverse-words-in-a-string/）</a></li>
</ul>
<p>动态规划</p>
<ul>
<li>【2】背包问题（<a href="http://baike.baidu.com/link?url=rhsiQhWz0xoYrm265bZQfow1IePC8X_MVUUlw9V9Ymu9g4Cwoqu-fjZIGOJZqe_V4ONMJlXug1IN0Cj_g0O3Ya）" target="_blank" rel="noopener">http://baike.baidu.com/link?url=rhsiQhWz0xoYrm265bZQfow1IePC8X_MVUUlw9V9Ymu9g4Cwoqu-fjZIGOJZqe_V4ONMJlXug1IN0Cj_g0O3Ya）</a></li>
<li>【3】连续子数组的最大和（<a href="https://leetcode.com/problems/maximum-subarray/）" target="_blank" rel="noopener">https://leetcode.com/problems/maximum-subarray/）</a></li>
<li>【4】实现简单的正则表达式匹配（<a href="https://leetcode.com/problems/regular-expression-matching/）" target="_blank" rel="noopener">https://leetcode.com/problems/regular-expression-matching/）</a></li>
</ul>
<p>数组</p>
<ul>
<li>【3】求两个等长、有序数组的中位数（二分法）</li>
<li>【4】求两个不等长、有序数组的中位数（<a href="https://leetcode.com/problems/median-of-two-sorted-arrays/）" target="_blank" rel="noopener">https://leetcode.com/problems/median-of-two-sorted-arrays/）</a></li>
<li>【3】旋转数组求最小值（二分法）（<a href="https://leetcode.com/problems/find-minimum-in-rotated-sorted-array/）" target="_blank" rel="noopener">https://leetcode.com/problems/find-minimum-in-rotated-sorted-array/）</a></li>
<li>【3】旋转数组求查找某个值是否存在（二分法）（<a href="https://leetcode.com/problems/search-in-rotated-sorted-array/）" target="_blank" rel="noopener">https://leetcode.com/problems/search-in-rotated-sorted-array/）</a></li>
<li>【4*】每行从左到右，每列从上到下递增的二维数组中，判断某个数是否存在（剑指 offer 第 3 题）</li>
<li>【3*】数组中出现次数超过一半的数字（<a href="https://bestswifter.com/arrayoccurmorethanhalf/）" target="_blank" rel="noopener">https://bestswifter.com/arrayoccurmorethanhalf/）</a></li>
<li>【3*】第 k 大的数（拓展：最大的 k 个数）（<a href="https://leetcode.com/problems/kth-largest-element-in-an-array/）" target="_blank" rel="noopener">https://leetcode.com/problems/kth-largest-element-in-an-array/）</a></li>
<li>【3*】有序数组中某个数字出现的次数（提示：利用二分搜索）</li>
</ul>
<p>链表</p>
<ul>
<li>【2】反转链表（使用递归和迭代两种解法，了解头插法）（<a href="https://leetcode.com/problems/reverse-linked-list/）" target="_blank" rel="noopener">https://leetcode.com/problems/reverse-linked-list/）</a></li>
<li>【3】删除链表的当前节点（<a href="https://leetcode.com/problems/delete-node-in-a-linked-list/）" target="_blank" rel="noopener">https://leetcode.com/problems/delete-node-in-a-linked-list/）</a></li>
<li>【3】删除倒数第 k 个节点（<a href="https://leetcode.com/problems/remove-nth-node-from-end-of-list/）" target="_blank" rel="noopener">https://leetcode.com/problems/remove-nth-node-from-end-of-list/）</a></li>
<li>【1】两个有序链表合并（<a href="https://leetcode.com/problems/merge-two-sorted-lists/）" target="_blank" rel="noopener">https://leetcode.com/problems/merge-two-sorted-lists/）</a></li>
<li>【4】复杂链表的复制（<a href="https://leetcode.com/problems/copy-list-with-random-pointer/）" target="_blank" rel="noopener">https://leetcode.com/problems/copy-list-with-random-pointer/）</a></li>
<li>【2*】判断链表是否有环（<a href="https://leetcode.com/problems/linked-list-cycle-ii/）" target="_blank" rel="noopener">https://leetcode.com/problems/linked-list-cycle-ii/）</a></li>
<li>【3*】两个链表的第一个公共节点（提示：考虑链表有环的情况）（<a href="http://blog.csdn.net/zzran/article/details/7984870）" target="_blank" rel="noopener">http://blog.csdn.net/zzran/article/details/7984870）</a></li>
<li>【3】删除链表中重复节点（<a href="https://leetcode.com/problems/remove-duplicates-from-sorted-list/）" target="_blank" rel="noopener">https://leetcode.com/problems/remove-duplicates-from-sorted-list/）</a></li>
</ul>
<p>树</p>
<ul>
<li>【3】根据中序和后序遍历结果重建二叉树（<a href="https://leetcode.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal/）" target="_blank" rel="noopener">https://leetcode.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal/）</a></li>
<li>【3】根据中序和前序遍历结果重建二叉树（<a href="https://leetcode.com/problems/construct-binary-tree-from-preorder-and-inorder-traversal/）" target="_blank" rel="noopener">https://leetcode.com/problems/construct-binary-tree-from-preorder-and-inorder-traversal/）</a></li>
<li>【2】翻转二叉树（<a href="https://leetcode.com/problems/invert-binary-tree/）" target="_blank" rel="noopener">https://leetcode.com/problems/invert-binary-tree/）</a></li>
<li>【2】从上往下打印二叉树 (BFS 的思想)（<a href="https://leetcode.com/problems/binary-tree-level-order-traversal-ii/）" target="_blank" rel="noopener">https://leetcode.com/problems/binary-tree-level-order-traversal-ii/）</a></li>
<li>【3】判断某个数组是不是二叉树的后序遍历结果 (剑指 offer 第 24 题)</li>
<li>【3】二叉树中和为某个值的路径（<a href="https://leetcode.com/problems/path-sum-ii/）" target="_blank" rel="noopener">https://leetcode.com/problems/path-sum-ii/）</a></li>
<li>【3*】二叉树中某个节点的下一个节点 (强烈推荐准备一下，剑指 offer 第 58 题)</li>
</ul>
<p>栈</p>
<ul>
<li>【2】用两个栈实现队列（<a href="https://leetcode.com/problems/implement-queue-using-stacks/）" target="_blank" rel="noopener">https://leetcode.com/problems/implement-queue-using-stacks/）</a></li>
<li>【2】用两个队列实现栈（<a href="https://leetcode.com/problems/implement-stack-using-queues/）" target="_blank" rel="noopener">https://leetcode.com/problems/implement-stack-using-queues/）</a></li>
<li>【2】实现一个栈，可以用常数级时间找出栈中的最小值（<a href="https://leetcode.com/problems/min-stack/）" target="_blank" rel="noopener">https://leetcode.com/problems/min-stack/）</a></li>
<li>【3】判断栈的压栈、弹栈序列是否合法（剑指offer 第 22 题）</li>
</ul>
<p>排序</p>
<p>了解以下排序的时间、空间复杂度，是否稳定，实现原理</p>
<ul>
<li>归并排序、拓展：求数组中的逆序对个数（<a href="http://baike.baidu.com/link?url=awQj_m-d5Lf_g5TglfU3uN55-0Dt2SmFv3IZx6-Ia86dOyyBoxkJhDyc2oFAzlUXFIXhs2dGehbHAHDqr1DuAK）" target="_blank" rel="noopener">http://baike.baidu.com/link?url=awQj_m-d5Lf_g5TglfU3uN55-0Dt2SmFv3IZx6-Ia86dOyyBoxkJhDyc2oFAzlUXFIXhs2dGehbHAHDqr1DuAK）</a></li>
<li>快速排序 重点：partion 函数的实现（<a href="http://baike.baidu.com/link?url=_sdhFCTSDKNM6wA5OCgqHTJc9kLWjiQBPLzO9-Cw_bYh4vZ7ofkBqySVw-MQDsJfOO9g9SJb2OCuL3yAmHIPWvv_sSPOsf-JZfKOU8QV3HrhInkkfGJ6j5Li4u3nWwiZkQlOUlGEZI-gLIyObuEM7bqwZPR8gLyVEiqutVr8pIDa6gF7cB8eixeQyur2yUt7）" target="_blank" rel="noopener">http://baike.baidu.com/link?url=_sdhFCTSDKNM6wA5OCgqHTJc9kLWjiQBPLzO9-Cw_bYh4vZ7ofkBqySVw-MQDsJfOO9g9SJb2OCuL3yAmHIPWvv_sSPOsf-JZfKOU8QV3HrhInkkfGJ6j5Li4u3nWwiZkQlOUlGEZI-gLIyObuEM7bqwZPR8gLyVEiqutVr8pIDa6gF7cB8eixeQyur2yUt7）</a></li>
<li>堆排序（<a href="http://baike.baidu.com/link?url=eioUPqfLTP0mqIOIuJdH0tp9m3ihgtx2rjcFMDpKhNXcjRidBGuk-XuQtM2Zl0z6J43yKq8VTDfFRzCsN4zj3_）" target="_blank" rel="noopener">http://baike.baidu.com/link?url=eioUPqfLTP0mqIOIuJdH0tp9m3ihgtx2rjcFMDpKhNXcjRidBGuk-XuQtM2Zl0z6J43yKq8VTDfFRzCsN4zj3_）</a></li>
<li>数组元素值域已知时，考虑 基数排序 和 桶排序（<a href="http://baike.baidu.com/view/1170573.htm）（http://baike.baidu.com/view/1784217.htm）" target="_blank" rel="noopener">http://baike.baidu.com/view/1170573.htm）（http://baike.baidu.com/view/1784217.htm）</a></li>
</ul>
<p>位运算</p>
<ul>
<li>【2】给一个十进制数字，求它的二进制表示中，有多少个 1 (n &amp;= n - 1)（<a href="https://leetcode.com/problems/number-of-1-bits/）" target="_blank" rel="noopener">https://leetcode.com/problems/number-of-1-bits/）</a></li>
<li>【3】给一个数组，所有数字都出现了偶数次，只有一个出现了一次，找出这个数（<a href="https://leetcode.com/problems/single-number/）" target="_blank" rel="noopener">https://leetcode.com/problems/single-number/）</a></li>
<li>【4】给一个数组，所有数字都出现了三次，只有一个出现了一次，找出这个数（<a href="https://leetcode.com/problems/single-number-ii/）" target="_blank" rel="noopener">https://leetcode.com/problems/single-number-ii/）</a></li>
<li>【3】给一个数组，所有数组都出现了偶数次，只有两个数字出现了一次，找出这两个数（<a href="https://leetcode.com/problems/single-number-iii/）" target="_blank" rel="noopener">https://leetcode.com/problems/single-number-iii/）</a></li>
</ul>
<h3 id="网络-1"><a href="#网络-1" class="headerlink" title="网络"></a>网络</h3><p>根据不同的面试岗位，侧重点略有不同。对 iOS 和 Android 开发者来说，HTTP 考的略少，以 TCP 和 UDP 为主。其实 UDP 基本上只会考察和 TCP 的区别。</p>
<p>当然还有一些常见的基础问题，比如 Cookie 和 Session 的考察，POST 和 GET 的考察，HTTPS 的简单了解等。这些问题在我的博客中都有简单的总结。</p>
<ul>
<li>【博客】我的六篇总结————不到一周（<a href="http://www.jianshu.com/notebooks/3276500/latest）" target="_blank" rel="noopener">http://www.jianshu.com/notebooks/3276500/latest）</a></li>
<li>【书】图解 TCP/IP————半个月（<a href="http://item.jd.com/11253710.html）" target="_blank" rel="noopener">http://item.jd.com/11253710.html）</a></li>
<li>【书】TCP/IP 详解————没读过，感觉至少需要一个月（<a href="http://item.jd.com/11182320.html）" target="_blank" rel="noopener">http://item.jd.com/11182320.html）</a></li>
<li>【书】TCP/IP 协议簇————没读过，感觉至少需要一个月（<a href="http://item.jd.com/10485475.html）" target="_blank" rel="noopener">http://item.jd.com/10485475.html）</a></li>
</ul>
<p>光读书是没有用的，一问到实际问题很容易懵逼，以下是我总结的一些问题：</p>
<ul>
<li>简介 TCP 和 UDP 区别，他们位于哪一层？</li>
<li>路由器和交换机的工作原理大概是什么，他们分别用到什么协议，位于哪一层？</li>
<li>描述TCP 协议三次握手，四次释放的过程。</li>
<li>TCP 协议是如何进行流量控制，拥塞控制的？</li>
<li>为什么建立连接时是三次握手，两次行不行？如果第三次握手失败了怎么处理</li>
<li>关闭连接时，第四次握手失败怎么处理？</li>
<li>你怎么理解分层和协议？</li>
<li>HTTP 请求中的 GET 和 POST 的区别，Session 和 Cookie 的区别。（<a href="https://bestswifter.com/bat-interview/(http://www.w3school.com.cn/tags/html_ref_httpmethods.asp)）" target="_blank" rel="noopener">https://bestswifter.com/bat-interview/(http://www.w3school.com.cn/tags/html_ref_httpmethods.asp)）</a></li>
<li>谈谈你对 HTTP 1.1，2.0 和 HTTPS 的理解。</li>
</ul>
<h3 id="操作系统与编译"><a href="#操作系统与编译" class="headerlink" title="操作系统与编译"></a>操作系统与编译</h3><p>我被问到的操作系统问题很少，所以仅仅总结了一些自认为比较重要的问题。关于这一部分的知识，推荐阅读《程序员的自我修养》，如果时间有限，你可以阅读我的《程序员的自我修养读书笔记》（<a href="https://bestswifter.com/cheng-xu-yuan-de-zi-wo-xiu-yang-du-shu-bi-ji/），并思考这些问题：" target="_blank" rel="noopener">https://bestswifter.com/cheng-xu-yuan-de-zi-wo-xiu-yang-du-shu-bi-ji/），并思考这些问题：</a></p>
<ul>
<li>源代码是怎么变成可执行文件的，每一步的作用是什么？（预编译，词法分析，语法分析，语义分析，中间语言生成目标代码生成，汇编，链接）</li>
<li>应用层、API、运行库、系统调用、操作系统内核之间的关系是什么？</li>
<li>虚拟内存空间是什么，为什么要有虚拟内存空间。</li>
<li>静态链接和动态链接分别表示什么，大概是怎么实现的？</li>
<li>可执行文件的结构如何？（分为哪些段）</li>
<li>它是怎么装载进内存的，为什么要分段，分页，页错误是什么？</li>
<li>进程的内存格局是怎样的？（堆、栈、全局/静态区，代码区，常量区）</li>
<li>堆和栈的区别，函数调用和栈的关系</li>
<li>进程和线程的区别</li>
<li>异步和同步，串行，并发，并行的区别</li>
<li>多并发任务，仅多线程能加快速度么（不能，会变慢，有线程切换的开销）</li>
<li>多个线程之间可以共享那些数据</li>
<li>进程之间如何通信</li>
<li>介绍几种锁，他们的用途和区别</li>
</ul>
<p>关于多线程相关的，推荐阅读这篇文章的前面一小部分——《iOS多线程编程——GCD与NSOperation总结》（<a href="https://bestswifter.com/multithreadconclusion/）" target="_blank" rel="noopener">https://bestswifter.com/multithreadconclusion/）</a></p>
<p>关于操作系统和编译方面的文章，除了读原书和我的读书笔记外，还可以参考这篇文章——《修改一个数字破解Mac上的应用》（<a href="https://bestswifter.com/app-crack/）" target="_blank" rel="noopener">https://bestswifter.com/app-crack/）</a></p>
<h3 id="OC"><a href="#OC" class="headerlink" title="OC"></a>OC</h3><p>首先两本必备的神书一定是要读完的。一本是讲 OC 的《Effective Objective-C 2.0》，中文名叫：“编写高质量 iOS 与 OS X 代码的 52 个有效方法”。另一本书叫：《Objective-C 高级编程》。前者讲解 OC 中各种细节，后者主要讲了 ARC、Block 和 GCD。</p>
<p>光是读书，思考不够，很容易在面试时被问懵逼，所以建议一遍尝试回答面试真题，一边阅读以下总结性的文章，重要性不分先后：</p>
<ul>
<li>检测内存泄露（<a href="http://wereadteam.github.io/2016/02/22/MLeaksFinder/?from=singlemessage&amp;isappinstalled=0）" target="_blank" rel="noopener">http://wereadteam.github.io/2016/02/22/MLeaksFinder/?from=singlemessage&amp;isappinstalled=0）</a></li>
<li>KVO与KVC原理、KVO、Notification、Delegate优缺点、最推荐的官方文档（<a href="http://www.jianshu.com/p/f1393d10109d）（http://www.tuicool.com/articles/mUVJVb）" target="_blank" rel="noopener">http://www.jianshu.com/p/f1393d10109d）（http://www.tuicool.com/articles/mUVJVb）</a></li>
<li>GCD 与 NSOperation（<a href="https://bestswifter.com/multithreadconclusion/）" target="_blank" rel="noopener">https://bestswifter.com/multithreadconclusion/）</a></li>
<li>Runtime（<a href="http://www.ianisme.com/ios/2019.html）" target="_blank" rel="noopener">http://www.ianisme.com/ios/2019.html）</a></li>
<li>block（<a href="http://blog.ibireme.com/2013/11/27/objc-block/）" target="_blank" rel="noopener">http://blog.ibireme.com/2013/11/27/objc-block/）</a></li>
<li>atomic 线程安全、@synchronized（<a href="http://www.cocoachina.com/bbs/read.php?tid-301674.html）（http://www.cnblogs.com/wendingding/p/3805841.html）" target="_blank" rel="noopener">http://www.cocoachina.com/bbs/read.php?tid-301674.html）（http://www.cnblogs.com/wendingding/p/3805841.html）</a></li>
<li>对象的深浅复制（<a href="https://bestswifter.com/differenceofcopybettenswiftandoc/）" target="_blank" rel="noopener">https://bestswifter.com/differenceofcopybettenswiftandoc/）</a></li>
<li>招聘一个靠谱的iOS（<a href="https://github.com/ChenYilong/iOSInterviewQuestions/tree/master/01%E3%80%8A%E6%8B%9B%E8%81%98%E4%B8%80%E4%B8%AA%E9%9D%A0%E8%B0%B1%E7%9A%84iOS%E3%80%8B%E9%9D%A2%E8%AF%95%E9%A2%98%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88）" target="_blank" rel="noopener">https://github.com/ChenYilong/iOSInterviewQuestions/tree/master/01%E3%80%8A%E6%8B%9B%E8%81%98%E4%B8%80%E4%B8%AA%E9%9D%A0%E8%B0%B1%E7%9A%84iOS%E3%80%8B%E9%9D%A2%E8%AF%95%E9%A2%98%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88）</a></li>
<li>消息传递机制（<a href="http://objccn.io/issue-7-4/）" target="_blank" rel="noopener">http://objccn.io/issue-7-4/）</a></li>
<li>深入理解Objective-C：Category（<a href="http://tech.meituan.com/DiveIntoCategory.html）" target="_blank" rel="noopener">http://tech.meituan.com/DiveIntoCategory.html）</a></li>
</ul>
<p>强烈推荐第八篇文章，做完这上面的题目基本上可以应付大多数 OC 方面的问题了。</p>
<h3 id="iOS-开发"><a href="#iOS-开发" class="headerlink" title="iOS 开发"></a>iOS 开发</h3><ul>
<li>RunLoop（<a href="http://blog.ibireme.com/2015/05/18/runloop/）" target="_blank" rel="noopener">http://blog.ibireme.com/2015/05/18/runloop/）</a></li>
<li>Cell 图片异步加载优化（<a href="http://www.jianshu.com/p/02ab2b74c451）" target="_blank" rel="noopener">http://www.jianshu.com/p/02ab2b74c451）</a></li>
<li>iOS 函数式编程的实现 &amp;&amp; 响应式编程概念（<a href="http://www.cocoachina.com/ios/20160307/15585.html）" target="_blank" rel="noopener">http://www.cocoachina.com/ios/20160307/15585.html）</a></li>
<li>内存恶鬼drawRect（<a href="http://bihongbo.com/2016/01/03/memoryGhostdrawRect/）" target="_blank" rel="noopener">http://bihongbo.com/2016/01/03/memoryGhostdrawRect/）</a></li>
<li>UIKit 性能调优(主要是UITableView)（<a href="https://bestswifter.com/uikitxing-neng-diao-you-shi-zhan-jiang-jie/）" target="_blank" rel="noopener">https://bestswifter.com/uikitxing-neng-diao-you-shi-zhan-jiang-jie/）</a></li>
<li>优化UITableViewCell高度计算的那些事（<a href="http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/）" target="_blank" rel="noopener">http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/）</a></li>
<li>高性能图片架构与设计（<a href="http://zhuanlan.zhihu.com/magilu/20273299）" target="_blank" rel="noopener">http://zhuanlan.zhihu.com/magilu/20273299）</a></li>
<li>轻量化视图控制器（<a href="http://objccn.io/issue-1-1/）" target="_blank" rel="noopener">http://objccn.io/issue-1-1/）</a></li>
<li>UIView的生命周期（<a href="https://bestswifter.com/uiviewlifetime/）" target="_blank" rel="noopener">https://bestswifter.com/uiviewlifetime/）</a></li>
<li>高效设置圆角（<a href="https://bestswifter.com/efficient-rounded-corner/）" target="_blank" rel="noopener">https://bestswifter.com/efficient-rounded-corner/）</a></li>
<li>事件的传递和响应机制（<a href="http://www.jianshu.com/p/2e074db792ba）" target="_blank" rel="noopener">http://www.jianshu.com/p/2e074db792ba）</a></li>
<li>ReactiveCocoa 和 MVVM 入门（<a href="http://yulingtianxia.com/blog/2015/05/21/ReactiveCocoa-and-MVVM-an-Introduction/）" target="_blank" rel="noopener">http://yulingtianxia.com/blog/2015/05/21/ReactiveCocoa-and-MVVM-an-Introduction/）</a></li>
</ul>
<p>其中需要重点了解 runloop，它不仅仅是简单的“跑圈”的 概念，很多问题其实都与它有关，建议认真阅读 ibireme 大神的总结</p>
<h3 id="其他面经"><a href="#其他面经" class="headerlink" title="其他面经"></a>其他面经</h3><p>我是如何同时拿到阿里和腾讯offer的（<a href="https://segmentfault.com/a/1190000002627927#articleHeader5）" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002627927#articleHeader5）</a><br>大三学生拿到阿里,百度实习offer面试经验分享（<a href="http://www.wtoutiao.com/p/e2fwlu.html）" target="_blank" rel="noopener">http://www.wtoutiao.com/p/e2fwlu.html）</a><br>2016年1月TX电面题（<a href="http://blog.csdn.net/xieyupeng520/article/details/50681147）" target="_blank" rel="noopener">http://blog.csdn.net/xieyupeng520/article/details/50681147）</a></p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol>
<li><a href="https://bestswifter.com/bat-interview/" target="_blank" rel="noopener">让 BAT 的 Offer 不再难拿 - bestswifter</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/04/【Android】零基础学-Java？看这篇就够了！/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mayan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mayan`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/04/【Android】零基础学-Java？看这篇就够了！/" itemprop="url">【Android】零基础学 Java？看这篇就够了！</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-04T22:02:13+08:00">
                2018-05-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/05/04/【Android】零基础学-Java？看这篇就够了！/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2018/05/04/【Android】零基础学-Java？看这篇就够了！/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/img/img010.png" alt="image010"></p>
<h2 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h2><h3 id="1-Java-语言概述"><a href="#1-Java-语言概述" class="headerlink" title="1. Java 语言概述"></a>1. Java 语言概述</h3><p>Java 是 SUN（Stanford University Network，斯坦福大学网络公司）1995 年推出的一门高级编程语言，是一种面向 Internet 的编程语言。</p>
<h3 id="2-Java-语言的三种技术架构"><a href="#2-Java-语言的三种技术架构" class="headerlink" title="2. Java 语言的三种技术架构"></a>2. Java 语言的三种技术架构</h3><p><strong>Java</strong> <strong>EE</strong>（Java Platform，Enterprise Edition，企业版），Java 5.0 以前称为 J2EE。Java EE 是在 Java SE 的基础上构建的。简单点说 Java EE 是用来做网站的。</p>
<p><strong>Java</strong> <strong>SE</strong>（Java Platform，Standard Edition，标准版），Java 5.0 以前称为 J2SE。它允许开发和部署在桌面、服务器、嵌入式环境和实时环境中使用的 Java 应用程序。简单点说 Java SE 是用来做电脑上运行的软件的。</p>
<p><strong>Java</strong> <strong>ME</strong>（Java Platform，Micro Edition，微型版），Java 5.0 以前称为 J2ME。Java ME 为在移动设备和嵌入式设备上运行的应用程序提供环境。简单点说 Java ME 是用来做手机软件的。</p>
<h3 id="3-Java-语言特点"><a href="#3-Java-语言特点" class="headerlink" title="3. Java 语言特点"></a>3. Java 语言特点</h3><p><strong>跨平台性</strong>。只需在操作系统上安装 Java 虚拟机（JVM，Java Virtual Machine）即可，由 JVM 来负责 Java 程序在该系统中的运行。</p>
<h3 id="4-Java-语言环境搭建"><a href="#4-Java-语言环境搭建" class="headerlink" title="4. Java 语言环境搭建"></a>4. Java 语言环境搭建</h3><p><strong>JRE</strong>（Java Runtime Environment，Java 运行环境）。包括 JVM 和 Java 程序所需的核心类库等。</p>
<p><strong>JDK</strong>（Java Development Kit，Java 开发工具包）。其中包含 Java 的开发工具（编译工具、打包工具等）和 JRE，所以安装了 JDK 就不用再单独安装 JRE 了。下载地址：<a href="http://www.oracle.com" target="_blank" rel="noopener">http://www.oracle.com</a></p>
<p><img src="/img/img011.png" alt="image011"></p>
<p>JRE 仅仅是运行工具，如需要开发工具则需搭建 JDK。JDK 开发完成的 Java 程序，交给 JRE 去运行。</p>
<h2 id="二、初体验"><a href="#二、初体验" class="headerlink" title="二、初体验"></a>二、初体验</h2><h3 id="Hello-Java"><a href="#Hello-Java" class="headerlink" title="Hello Java"></a>Hello Java</h3><p>编写如下代码保存为 Demo.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello Java"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用终端，在 Demo.java 文件当前目录，输入如下命令进行编译：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ javac Demo.java</span><br></pre></td></tr></table></figure>
<p>编译成功后在 Demo.java 文件当前目录下生成 Demo.class 文件，输入如下命令运行：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ java Demo</span><br></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello Java</span><br></pre></td></tr></table></figure>
<h3 id="Mac-使用-Sublime-Text-3-搭建-Java-环境"><a href="#Mac-使用-Sublime-Text-3-搭建-Java-环境" class="headerlink" title="Mac 使用 Sublime Text 3 搭建 Java 环境"></a>Mac 使用 Sublime Text 3 搭建 Java 环境</h3><p>Sublime Text 默认的 Java 处理方式仅仅是编译，Build 后会生成一个 .class 文件，而没有去运行，这时候就需要改配置文件达到编译 + 运行的目的。</p>
<p><strong>1.</strong> <strong>Tools</strong> <strong>—&gt;</strong> <strong>Build</strong> <strong>System</strong> <strong>—&gt;</strong> <strong>New</strong> <strong>Build</strong> <strong>System</strong></p>
<p><img src="/img/img012.png" alt="image012"></p>
<p><strong>2.</strong> <strong>添加如下代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"shell_cmd"</span>: <span class="string">"javac -encoding utf-8 $file_name &amp;&amp; java $file_base_name"</span>,</span><br><span class="line">    <span class="string">"file_regex"</span>: <span class="string">"^ *\\[javac\\] (,+):([0-9]+):() (.*)$"</span>,</span><br><span class="line">    <span class="string">"selector"</span>: <span class="string">"source.java"</span>,</span><br><span class="line">    <span class="string">"encoding"</span>: <span class="string">"utf-8"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>3.</strong> <strong>直接保存，名字随意</strong></p>
<p><img src="/img/img013.png" alt="image013"></p>
<p><strong>4.</strong> <strong>Tools</strong> <strong>—&gt;</strong> <strong>Build</strong> <strong>System</strong> <strong>—&gt;</strong> <strong>选择上一步保存的配置文件</strong></p>
<p><img src="/img/img014.png" alt="image014"></p>
<p><strong>5.</strong> <strong>cmd</strong> <strong>+</strong> <strong>B</strong> <strong>编译运行，就有输出结果了</strong></p>
<p><img src="/img/img015.png" alt="image015"></p>
<h2 id="三、基本语法"><a href="#三、基本语法" class="headerlink" title="三、基本语法"></a>三、基本语法</h2><h3 id="1-名称规范"><a href="#1-名称规范" class="headerlink" title="1. 名称规范"></a>1. 名称规范</h3><ul>
<li><p>包名：多单词组成时，所有字母都小写 xxxyyyzzz</p>
</li>
<li><p>类名、接口名：多单词组成时，所有单词首字母大写 XxxYyyZyy</p>
</li>
<li><p>变量名和函数名：多单词组成时，第一个单词首字母小写，第二个单词开始每个单词首字母大写 xxxYyyZzz</p>
</li>
<li><p>常量名：多单词组成时，每个单词用下划线连接，所有字母都大写 XXX_YYY_ZZZ</p>
</li>
</ul>
<h3 id="2-基本数据类型"><a href="#2-基本数据类型" class="headerlink" title="2. 基本数据类型"></a>2. 基本数据类型</h3><p>Java 语言是强类型语言，对于每一种数据都定义了明确的具体数据类型，在内存中分配了不同大小的内存空间。</p>
<p><strong>整数型</strong>：byte、short（2 byte）、int（4 byte）、long（8 byte）</p>
<blockquote>
<p>1 byte = 8 bit，1 字节 = 8 位</p>
<p>1 byte 取值范围是 -128 ~ 127，也就是 -2^7 ~ 2^7-1</p>
<p>1 short 取值范围是 -32768 ~ 32767，也就是 -2^15 ~ 2^15-1</p>
<p>1 int 取值范围是 -2^31 ~ 2^31-1</p>
</blockquote>
<p><strong>浮点型</strong>：float（4 byte）、double（8 byte）</p>
<p><strong>字符型</strong>：char（1 byte）</p>
<blockquote>
<p>1 char 取值范围是 0 ~ 65535，也就是 0 ~ 2^16-1</p>
</blockquote>
<p><strong>布尔型</strong>：boolean（1 byte）</p>
<h3 id="3-逻辑运算符"><a href="#3-逻辑运算符" class="headerlink" title="3. 逻辑运算符"></a>3. 逻辑运算符</h3><p><strong>&amp;</strong>：无论左边是 true 还是 false，右边都运算；</p>
<p><strong>&amp;&amp;</strong>：当左边为 false 时，右边不运算；</p>
<p><strong>|</strong>：无论左边是 true 还是 false，右边都运算；</p>
<p><strong>||</strong>：当左边为 true 时，右边不运算；</p>
<p><strong>^</strong>：两边结果相同为 false，两边结果不同为 true</p>
<blockquote>
<p>true ^ ture   = false;</p>
<p>false ^ false = false;</p>
<p>true ^ false  = true;</p>
<p>false ^ true  = true;</p>
</blockquote>
<blockquote>
<p>应用场景</p>
<ol>
<li><p>一个数异或同一个数两次，结果不变（7^4^4 = 7），一般用于加密解密</p>
</li>
<li><p>数值交换</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; n = n^m;</span><br><span class="line">&gt; m = n^m;</span><br><span class="line">&gt; n = n^m;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>这种方法比加减方法好，因为如果 n 和 m 的值非常大，容易超出 int 范围</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; n = n+m;</span><br><span class="line">&gt; m = n-m;</span><br><span class="line">&gt; n = n-m;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="4-位运算符"><a href="#4-位运算符" class="headerlink" title="4. 位运算符"></a>4. 位运算符</h3><p><strong>左移</strong> <strong>/</strong> <strong>右移</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> &lt;&lt; <span class="number">2</span> = <span class="number">12</span>;  <span class="comment">// 相当于 3 乘以 2 ^ 2，3 * 4</span></span><br><span class="line"><span class="number">6</span> &gt;&gt; <span class="number">1</span> = <span class="number">3</span>;   <span class="comment">// 相当于 6 除以 2 ^ 1，6 / 2</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>应用场景：乘法需要转换成二进制位位相乘，比较费事，使用位运算节省时间</p>
</blockquote>
<p><strong>有符号位移</strong> <strong>/</strong> <strong>无符号位移</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="number">6</span> &gt;&gt; <span class="number">1</span>;   <span class="comment">// 右移后，左边高位用 1 补位</span></span><br><span class="line">-<span class="number">6</span> &gt;&gt;&gt; <span class="number">1</span>;  <span class="comment">// 右移后，左边高位用 0 补位</span></span><br></pre></td></tr></table></figure>
<p><strong>与运算</strong> <strong>/</strong> <strong>或运算</strong> <strong>/</strong> <strong>异或运算</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span> &amp; <span class="number">5</span> = <span class="number">4</span>;</span><br><span class="line"><span class="number">6</span> | <span class="number">5</span> = <span class="number">7</span>;</span><br><span class="line"><span class="number">6</span> ^ <span class="number">5</span> = <span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<h3 id="5-循环语句"><a href="#5-循环语句" class="headerlink" title="5. 循环语句"></a>5. 循环语句</h3><h4 id="打印九九乘法表"><a href="#打印九九乘法表" class="headerlink" title="打印九九乘法表"></a>打印九九乘法表</h4><p>下面例子不是介绍九九乘法表的算法，而是 <code>\t</code> 制表符的应用。如果用空格，打印中在某一行会没有对齐，如果用制表符则不用考虑这个问题：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++) &#123;</span><br><span class="line">        System.out.println(j + <span class="string">"*"</span> + i + <span class="string">"="</span> + j*i + <span class="string">"\t"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="跳出多层循环嵌套"><a href="#跳出多层循环嵌套" class="headerlink" title="跳出多层循环嵌套"></a>跳出多层循环嵌套</h4><p>如下例子，仅仅打印了 <code>1*1=1</code> 就跳出循环了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">w: <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; i++) &#123;</span><br><span class="line">    q: <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++) &#123;</span><br><span class="line">           System.out.println(j + <span class="string">"*"</span> + i + <span class="string">"="</span> + j*i + <span class="string">"\t"</span>);</span><br><span class="line">           <span class="keyword">break</span> w;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-数组"><a href="#6-数组" class="headerlink" title="6. 数组"></a>6. 数组</h3><h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一维数组</span></span><br><span class="line"><span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span>[] arr = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 二维数组</span></span><br><span class="line"><span class="keyword">int</span>[][] arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>][];  <span class="comment">// 二维数组第二维可以不定义长度，默认第一维指向为空</span></span><br><span class="line">System.out.println(arr[<span class="number">1</span>]);  <span class="comment">// 打印结果为 null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span>[][] arr = &#123;&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;, &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="数组存储原理"><a href="#数组存储原理" class="headerlink" title="数组存储原理"></a>数组存储原理</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] x = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br></pre></td></tr></table></figure>
<p>以上面创建数组为例，x 存储到栈内存中，new int[3] 存储到堆内存中。x 存储的不是 new int[3] 本身，而是 new int[3] 的起始内存地址（例如是 0x0079），也就是 x 指向了该内存地址。并且堆内存中，只要被创建，就会有初始化值。</p>
<p>当不想要 x 这个数组了，则将 x 置为 null，x 不指向之前的地址了，数组在堆内存中则不被使用了。java 虚拟机则将该数组视为垃圾，但是不会立刻将其清除掉，会不定时的启动垃圾回收机制，将该数组实体在堆内存中清除。</p>
<blockquote>
<p>垃圾回收机制不同于 c++，需要程序员自己将堆内存中垃圾清除，java 将这里做了优化。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arr2 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">5</span>];</span><br><span class="line">System.out.println(arr2);</span><br></pre></td></tr></table></figure>
<p>打印的结果为：<code>[I@43556938</code>，<code>[</code> 代表数组，<code>I</code> 代表 int 数据类型，<code>@</code> 右边的为数组内存存放地址，其为哈希算法算出来的哈希值。如果是二维数组，其打印结果为 <code>[[I@43556938</code></p>
<h4 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a>数组排序</h4><p>实际开发中只调用 <code>Arrays.sort(arr)</code> 即可实现排序，但是需要声明 <code>import java.util.Arrays</code> 包：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>[] arr = &#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>&#125;;</span><br><span class="line">    Arrays.sort(arr);</span><br><span class="line"></span><br><span class="line">    System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-进制转换"><a href="#7-进制转换" class="headerlink" title="7. 进制转换"></a>7. 进制转换</h3><h4 id="十进制转换成二进制"><a href="#十进制转换成二进制" class="headerlink" title="十进制转换成二进制"></a>十进制转换成二进制</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(Integer.toBinaryString(<span class="number">6</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法二</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        toBin(<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">toBin</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">            sb.append(num % <span class="number">2</span>);</span><br><span class="line">            num = num &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(sb.reverse());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法三（查表法）</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        toBin(<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">toBin</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">char</span>[] chars = &#123;<span class="string">'0'</span>, <span class="string">'1'</span>&#125;;</span><br><span class="line"></span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">            sb.append(chars[num &amp; <span class="number">1</span>]);</span><br><span class="line">            num = num &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(sb.reverse());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="十进制转换成十六进制"><a href="#十进制转换成十六进制" class="headerlink" title="十进制转换成十六进制"></a>十进制转换成十六进制</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(Integer.toHexString(<span class="number">60</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法二</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        toHex(<span class="number">60</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">toHex</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; <span class="number">8</span>; x++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 15 的二进制表达形式为 1111，num 和 15 与运算结果为最后四位的值</span></span><br><span class="line">            <span class="keyword">int</span> tmp = num &amp; <span class="number">15</span>;              </span><br><span class="line">            <span class="keyword">if</span> (tmp &gt; <span class="number">9</span>) &#123;</span><br><span class="line">                sb.append((<span class="keyword">char</span>)(tmp - <span class="number">10</span> + <span class="string">'a'</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                sb.append(tmp);</span><br><span class="line">            &#125;</span><br><span class="line">            num = num &gt;&gt; <span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(sb.reverse());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法三（查表法）</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        toHex(<span class="number">60</span>);</span><br><span class="line">        System.out.println(Integer.toHexString(<span class="number">60</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">toHex</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">char</span>[] chars = &#123;<span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>&#125;;</span><br><span class="line"></span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; <span class="number">8</span>; x++) &#123;</span><br><span class="line"></span><br><span class="line">            sb.append(chars[num &amp; <span class="number">15</span>]);</span><br><span class="line">            num = num &gt;&gt; <span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(sb.reverse());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="四、函数"><a href="#四、函数" class="headerlink" title="四、函数"></a>四、函数</h2><p>面向对象三个特征：</p>
<ul>
<li><strong>封装</strong>、<strong>继承</strong>、<strong>多态</strong>。</li>
</ul>
<p>两种变量：</p>
<ul>
<li>成员变量：定义在函数之外，存在堆内存中。</li>
<li>局部变量：定义在函数之内，存在栈内存中。</li>
</ul>
<h3 id="1-重载"><a href="#1-重载" class="headerlink" title="1. 重载"></a>1. 重载</h3><p><strong>定义</strong>：在同一个类中，允许存在一个以上的同名函数，只要它们的参数个数或者参数类似不同即可。</p>
<p><strong>应用场景</strong>：当定义的功能相同，但参与运算的未知内容不同。那么，这时就定义一个函数名称以表示其功能，方便阅读，而通过参数列表的不同来区分多个同名函数。</p>
<p><strong>判断是否重载</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">char</span> b, <span class="keyword">double</span> c)</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">a.</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">char</span> y, <span class="keyword">double</span> z)</span></span>&#123;&#125;  <span class="comment">// 没有，因为和原函数一样</span></span><br><span class="line"></span><br><span class="line">b.</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">double</span> b, <span class="keyword">char</span> c)</span></span>&#123;&#125;  <span class="comment">// 重载，因为参数类型不同   </span></span><br><span class="line"></span><br><span class="line">c.</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">char</span> b)</span></span>&#123;&#125;  <span class="comment">// 重载，因为参数个数不同</span></span><br><span class="line"></span><br><span class="line">d.</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">char</span> b, <span class="keyword">double</span> c)</span></span>&#123;&#125;  <span class="comment">// 没有，重载和返回值类型没有关系</span></span><br></pre></td></tr></table></figure>
<h3 id="2-私有权限修饰符"><a href="#2-私有权限修饰符" class="headerlink" title="2. 私有权限修饰符"></a>2. 私有权限修饰符</h3><p><strong>private</strong>：私有权限修饰符，用于修饰类中的成员变量、成员函数。只能在该类中访问，在外部不能访问。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">run</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I`m running."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Person p = <span class="keyword">new</span> Person();</span><br><span class="line">        p.age = <span class="number">20</span>;</span><br><span class="line">        p.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面例子中，Person 类的 <code>age</code> 不可以赋值，同时 <code>run()</code> 方法也不可调用。</p>
<h3 id="3-构造函数"><a href="#3-构造函数" class="headerlink" title="3. 构造函数"></a>3. 构造函数</h3><p><strong>构造函数</strong>：可以用于给对象进行初始化，当一个类中没有定义构造函数，那么系统会默认给该类加入一个空参数的构造函数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 就相当于重写 init 初始化</span></span><br><span class="line">    Person() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Person(String n) &#123;</span><br><span class="line">        <span class="keyword">this</span>();</span><br><span class="line">        <span class="keyword">this</span>.name = n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Person(String n, <span class="keyword">int</span> a) &#123;</span><br><span class="line">        <span class="keyword">this</span>();</span><br><span class="line">        <span class="keyword">this</span>.name = n;</span><br><span class="line">        <span class="keyword">this</span>.age = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Person: name = "</span> + name + <span class="string">", age = "</span> + age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">        Person p1 = <span class="keyword">new</span> Person(); </span><br><span class="line">        p1.say();</span><br><span class="line"></span><br><span class="line">        Person p2 = <span class="keyword">new</span> Person(<span class="string">"mayan"</span>);</span><br><span class="line">        p2.say();</span><br><span class="line"></span><br><span class="line">        Person p3 = <span class="keyword">new</span> Person(<span class="string">"mayan"</span>, <span class="number">25</span>);</span><br><span class="line">        p3.say();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Person: name = <span class="keyword">null</span>, age = <span class="number">0</span></span><br><span class="line">Person: name = mayan, age = <span class="number">0</span></span><br><span class="line">Person: name = mayan, age = <span class="number">25</span></span><br></pre></td></tr></table></figure>
<h3 id="4-静态修饰符"><a href="#4-静态修饰符" class="headerlink" title="4. 静态修饰符"></a>4. 静态修饰符</h3><p>static 是一个修饰符，用于修饰成员变量/成员函数（不能修饰局部变量/局部函数）。</p>
<h4 id="类变量和实例变量的区别"><a href="#类变量和实例变量的区别" class="headerlink" title="类变量和实例变量的区别"></a>类变量和实例变量的区别</h4><p>被 static 修饰的静态成员变量，称为类变量；不被 static 修饰的成员变量，称为实例变量，也就是对象变量。</p>
<ol>
<li>存放位置，类变量随着类的加载而存在于方法区中；实例变量随着对象的建立而存在于堆内存中。</li>
<li>生命周期，类变量随着类的消失而消失；实例变量随着对象的消失而消失。</li>
<li>调用方式，类变量可以被类名或者对象调用；实例变量必须被对象调用。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">	<span class="keyword">static</span> String country = <span class="string">"CN"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	    Person p = <span class="keyword">new</span> Person(); </span><br><span class="line"></span><br><span class="line">	    <span class="comment">// 打印的结果都是 "CN"</span></span><br><span class="line">	    System.out.println(p.country);</span><br><span class="line">	    System.out.println(Person.country);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="静态的利弊"><a href="#静态的利弊" class="headerlink" title="静态的利弊"></a>静态的利弊</h4><ul>
<li>利处：对对象的共享数据进行单独空间存储，节省空间。没有必要每一个对象中都存储一份，可以直接被类名调用。</li>
<li>弊端：生命周期过长，访问出现局限性，只能访问静态。</li>
</ul>
<h3 id="5-主函数"><a href="#5-主函数" class="headerlink" title="5. 主函数"></a>5. 主函数</h3><p>main 函数解析：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// public : 代表该函数访问权限是最大的 </span></span><br><span class="line"><span class="comment">// static : 代表主函数随着类的加载就已经存在了 </span></span><br><span class="line"><span class="comment">// void   : 主函数没有具体的返回值 </span></span><br><span class="line"><span class="comment">// main   : 不是关键字，但是是一个特殊的单词，可以被 jvm 识别 </span></span><br><span class="line"><span class="comment">// args   : arguments 的缩写，意思为参数。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-类文档"><a href="#6-类文档" class="headerlink" title="6. 类文档"></a>6. 类文档</h3><p>新建一个文件 <code>Tool.java</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">这是一个基本函数工具类，该类目前提供了，获取两个数中最大值、最小值两个方法</span></span><br><span class="line"><span class="comment"><span class="doctag">@author</span> mayan</span></span><br><span class="line"><span class="comment"><span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tool</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    获取两个数中最大值</span></span><br><span class="line"><span class="comment">    <span class="doctag">@param</span> num1 两个比较的数中其一</span></span><br><span class="line"><span class="comment">    <span class="doctag">@param</span> num2 两个比较的数中其二</span></span><br><span class="line"><span class="comment">    <span class="doctag">@return</span> 返回其中最大的数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	    <span class="keyword">return</span> num1 &gt; num2 ? num1 : num2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    获取两个数中最小值</span></span><br><span class="line"><span class="comment">    <span class="doctag">@param</span> num1 两个比较的数中其一</span></span><br><span class="line"><span class="comment">    <span class="doctag">@param</span> num2 两个比较的数中其二</span></span><br><span class="line"><span class="comment">    <span class="doctag">@return</span> 返回其中最小的数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> num1 &lt; num2 ? num1 : num2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 <code>Demo.java</code> 文件中调用工具类中的函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> num = Tool.max(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">        System.out.println(num);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>进入该工具类所在的文件夹，在终端输入如下命令，可在该路径下生成文档</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ javadoc -d myhelp -author -version Tool.java -encoding utf-<span class="number">8</span> -charset utf-<span class="number">8</span></span><br></pre></td></tr></table></figure>
<h3 id="7-静态代码块"><a href="#7-静态代码块" class="headerlink" title="7. 静态代码块"></a>7. 静态代码块</h3><p>静态代码块随着类的加载而执行，并且只执行一次，用于给类进行初始化。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">26</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"I`m a man"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">"I`m "</span> + <span class="keyword">this</span>.age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I`m crying"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Person p1 = <span class="keyword">new</span> Person();</span><br><span class="line">        p1.cry();</span><br><span class="line"></span><br><span class="line">        Person p2 = <span class="keyword">new</span> Person();</span><br><span class="line">        p2.cry();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果如下，其中打印年龄的为代码块，每次创建对象都会运行一次，因为 age 的初始化在其前面，所以代码块里面可以调用 <code>this.age</code> 方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">I`m a man</span><br><span class="line">I`m <span class="number">26</span></span><br><span class="line">I`m crying</span><br><span class="line">I`m <span class="number">26</span></span><br><span class="line">I`m crying</span><br></pre></td></tr></table></figure>
<h3 id="8-对象初始化过程"><a href="#8-对象初始化过程" class="headerlink" title="8. 对象初始化过程"></a>8. 对象初始化过程</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person p = <span class="keyword">new</span> Person();</span><br></pre></td></tr></table></figure>
<p>上面初始化方法都做了哪些事情？</p>
<ol>
<li>首先 javac 编译 .java 源文件形成 .class 字节码文件；</li>
<li>JVM 的类加载器将 Person.class 文件加载到内存中；</li>
<li>先初始化类中静态属性，再初始化静态代码块；</li>
<li>在堆内存中开辟空间，分配内存地址；</li>
<li>初始化特有属性；</li>
<li>初始化构造代码块；</li>
<li>初始化构造函数；</li>
<li>将内存地址赋给栈内存中的 p 变量。</li>
</ol>
<h3 id="9-单例设计模式"><a href="#9-单例设计模式" class="headerlink" title="9. 单例设计模式"></a>9. 单例设计模式</h3><h4 id="饿汉式"><a href="#饿汉式" class="headerlink" title="饿汉式"></a>饿汉式</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Single</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Single s = <span class="keyword">new</span> Single();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Single <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> s;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="懒汉式"><a href="#懒汉式" class="headerlink" title="懒汉式"></a>懒汉式</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Single</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Single s = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Single <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (s == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">synchronized</span>(Single.class) &#123;  <span class="comment">// 加锁</span></span><br><span class="line">				<span class="keyword">if</span> (s == <span class="keyword">null</span>) &#123;</span><br><span class="line">					s = <span class="keyword">new</span> Single();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> s;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上两种单例方法的调用，打印结果都相同</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Single s1 = Single.getInstance();</span><br><span class="line">		Single s2 = Single.getInstance();</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"s1 = "</span> + s1 + <span class="string">" s2 = "</span> + s2);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s1 = Single@<span class="number">2</span>cfb4a64 s2 = Single@<span class="number">2</span>cfb4a64</span><br></pre></td></tr></table></figure>
<h3 id="10-继承"><a href="#10-继承" class="headerlink" title="10. 继承"></a>10. 继承</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	String name;</span><br><span class="line">	<span class="keyword">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span> <span class="keyword">extends</span> <span class="title">Person</span>  </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Student s = <span class="keyword">new</span> Student();</span><br><span class="line">		s.name = <span class="string">"student"</span>;</span><br><span class="line">		s.age = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">		Worker w = <span class="keyword">new</span> Worker();</span><br><span class="line">		w.name = <span class="string">"worker"</span>;</span><br><span class="line">		w.age = <span class="number">26</span>;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"Student - "</span> + <span class="string">"name: "</span> + s.name + <span class="string">" age: "</span> + s.age);</span><br><span class="line">		System.out.println(<span class="string">"Worker - "</span> + <span class="string">"name: "</span> + w.name + <span class="string">" age: "</span> + w.age);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Student - name: student age: <span class="number">8</span></span><br><span class="line">Worker - name: worker age: <span class="number">26</span></span><br></pre></td></tr></table></figure>
<h4 id="final-修饰符"><a href="#final-修饰符" class="headerlink" title="final 修饰符"></a>final 修饰符</h4><ul>
<li>被 final 修饰的类不可以被继承</li>
<li>被 final 修饰的函数不能被复写</li>
<li>被 final 修饰的成员变量/局部变量是一个常量，只能赋值一次。</li>
</ul>
<h3 id="11-抽象类"><a href="#11-抽象类" class="headerlink" title="11. 抽象类"></a>11. 抽象类</h3><ul>
<li>抽象方法一定定义在抽象类中；</li>
<li>抽象方法和抽象类都必须被 abstract 关键字修饰；</li>
<li>抽象类不可以用 new 创建对象，因为调用抽象方法没意义；</li>
<li>抽象类中的方法要被使用，必须由子类复写所有的抽象方法后，建立子类对象调用；</li>
<li>如果子类只覆盖部分抽象方法，那么该子类还是一个抽象类；</li>
<li>特殊用法：抽象类中可以不定义抽象方法，这样做仅仅是不让该类建立对象。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"睡觉"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Science_student</span> <span class="keyword">extends</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">study</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"学习科学"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Art_student</span> <span class="keyword">extends</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">study</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"学习艺术"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Science_student ss = <span class="keyword">new</span> Science_student();</span><br><span class="line">		ss.study();</span><br><span class="line"></span><br><span class="line">		Art_student as = <span class="keyword">new</span> Art_student();</span><br><span class="line">		as.study();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">学习科学</span><br><span class="line">学习艺术</span><br></pre></td></tr></table></figure>
<h4 id="模板方法"><a href="#模板方法" class="headerlink" title="模板方法"></a>模板方法</h4><p>在定义功能时，功能的一部分是确定的，但是有一部分是不确定的。确定的部分在使用不确定的部分，将不确定的部分暴露出去，由该类的子类来完成。</p>
<p>应用场景：获取一段程序运行的时间</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">GetTime</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">getTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取当前时间</span></span><br><span class="line">		<span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">		runcode();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取当前时间</span></span><br><span class="line">		<span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"毫秒："</span> + (end - start));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">runcode</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetErgodicTime</span> <span class="keyword">extends</span> <span class="title">GetTime</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runcode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; <span class="number">10000</span>; x++) &#123;</span><br><span class="line">			System.out.println(x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		GetErgodicTime t = <span class="keyword">new</span> GetErgodicTime();</span><br><span class="line">		t.getTime();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">...</span><br><span class="line"><span class="number">9997</span></span><br><span class="line"><span class="number">9998</span></span><br><span class="line"><span class="number">9999</span></span><br><span class="line">毫秒：<span class="number">79</span></span><br></pre></td></tr></table></figure>
<h3 id="12-接口"><a href="#12-接口" class="headerlink" title="12. 接口"></a>12. 接口</h3><p>接口初期理解，可以认为是一个特殊的抽象类，当抽象类中的方法都是抽象的，那么该类可以通过接口的形式来表示。</p>
<ul>
<li>class：用于定义类</li>
<li>interface：用于定义接口</li>
</ul>
<p>接口中的成员都有固定修饰符</p>
<ul>
<li>常量：public static final</li>
<li>方法：public abstract</li>
</ul>
<p><strong>基本应用</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Inter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NUM = <span class="number">3</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">Inter</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Test t = <span class="keyword">new</span> Test();</span><br><span class="line">		System.out.println(t.NUM);</span><br><span class="line">		System.out.println(Test.NUM);</span><br><span class="line">		System.out.println(Inter.NUM);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<p><strong>多继承</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">InterA</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NUM = <span class="number">3</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">InterB</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">methodB</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">InterA</span>, <span class="title">InterB</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodB</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Test t = <span class="keyword">new</span> Test();</span><br><span class="line">		System.out.println(t.NUM);</span><br><span class="line">		System.out.println(Test.NUM);</span><br><span class="line">		System.out.println(Inter.NUM);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<p><strong>接口继承接口</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">InterA</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NUM = <span class="number">3</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">InterB</span> <span class="keyword">extends</span> <span class="title">InterA</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">methodB</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">InterB</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodB</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Test t = <span class="keyword">new</span> Test();</span><br><span class="line">		System.out.println(t.NUM);</span><br><span class="line">		System.out.println(Test.NUM);</span><br><span class="line">		System.out.println(Inter.NUM);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>抽象类和接口的区别</p>
<ol>
<li>抽象类可以有构造方法，接口不能有构造方法 </li>
<li>抽象类中可以有普通成员变量，接口中没有普通成员变量 </li>
<li>抽象类中可以包含非抽象的普通方法，接口中的所有方法必须是抽象的，不能有非抽象的普通方法 </li>
<li>抽象类中抽象方法的访问类型可以是 public、protected 和默认类型，接口中的抽象方法只能是 public 类型，并且默认即为 public abstract 类型 </li>
<li>抽象类中可以包含静态方法，接口中不能包含静态方法 </li>
<li>抽象类和接口中都可以包含静态成员变量，抽象类中的静态成员变量的访问类型可以任意，但接口中定义的变量只能是 public static final 类型</li>
<li>一个类只能继承一个抽象类，一个类可以实现多个接口</li>
<li>抽象类的设计理念是 <code>is a</code> 关系（继承），接口的设计理念是 <code>like a</code> 关系（功能扩展）</li>
</ol>
<h3 id="13-多态"><a href="#13-多态" class="headerlink" title="13. 多态"></a>13. 多态</h3><ul>
<li>多态的体现：父类的引用指向了自己的子类对象。</li>
<li>多态的前提：必须是类与类之间有关系，要么继承，要么实现。</li>
<li>多态的好处：提高了程序的扩展性。</li>
<li>多态的弊端：只能使用父类的引用访问父类中的成员。</li>
</ul>
<p><strong>基本应用</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(String thing)</span> </span>&#123;</span><br><span class="line">		System.out.println(thing);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"cat: 吃鱼"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"dog: 吃骨头"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Animal c = <span class="keyword">new</span> Cat();</span><br><span class="line">		Animal d = <span class="keyword">new</span> Dog();</span><br><span class="line"></span><br><span class="line">		function(c);</span><br><span class="line">		function(d);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">function</span><span class="params">(Animal a)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 先吃</span></span><br><span class="line">		a.eat();</span><br><span class="line"></span><br><span class="line">	 	<span class="comment">// 然后实现动作，正常不会这样判断，拓展性不好</span></span><br><span class="line">	 	<span class="keyword">if</span> (a <span class="keyword">instanceof</span> Cat) &#123;</span><br><span class="line">	 		</span><br><span class="line">	 		Cat c = (Cat)a;</span><br><span class="line">	 		c.doSomething(<span class="string">"cat: 捉老鼠"</span>);</span><br><span class="line">	 	&#125;</span><br><span class="line">	 	<span class="keyword">else</span> <span class="keyword">if</span> (a <span class="keyword">instanceof</span> Dog) &#123;</span><br><span class="line"></span><br><span class="line">	 		Dog d = (Dog)a;</span><br><span class="line">	 		d.doSomething(<span class="string">"dog: 看家"</span>);</span><br><span class="line">	 	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat: 吃鱼</span><br><span class="line">cat: 捉老鼠</span><br><span class="line">dog: 吃骨头</span><br><span class="line">dog: 看家</span><br></pre></td></tr></table></figure>
<p><strong>特殊情况 1</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	String name = <span class="string">"Father"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	String name = <span class="string">"Child"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Father f = <span class="keyword">new</span> Child();</span><br><span class="line">		System.out.println(f.name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Father</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<ol>
<li>在多态中，非静态成员变量无论编译和运行，都参考左边（引用型变量所属的类）。</li>
</ol>
<p><strong>特殊情况 2</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Father Method"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">staticMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Father StaticMethod"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Child Method"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">staticMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Child StaticMethod"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Father f = <span class="keyword">new</span> Child();</span><br><span class="line"></span><br><span class="line">		f.method();</span><br><span class="line">		f.staticMethod();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Child Method</span><br><span class="line">Father StaticMethod</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<ol>
<li>在多态中，静态成员函数无论编译和运行，都参考左边（引用型变量所属的类）；</li>
<li>非静态区用 this 来调用对象，所以会调用子类方法；而静态区用 Father 来调用对象，所以会调用父类方法。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/22/【iOS】保持界面流畅的技巧/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mayan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mayan`s blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/22/【iOS】保持界面流畅的技巧/" itemprop="url">【iOS】保持界面流畅的技巧</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-22T14:03:55+08:00">
                2018-03-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/03/22/【iOS】保持界面流畅的技巧/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2018/03/22/【iOS】保持界面流畅的技巧/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本文内容整理于以下文章：</p>
<ol>
<li><a href="https://blog.ibireme.com/2015/11/12/smooth_user_interfaces_for_ios/" target="_blank" rel="noopener">iOS 保持界面流畅的技巧 - ibireme</a></li>
<li><a href="https://segmentfault.com/a/1190000006699632" target="_blank" rel="noopener">使用 ASDK 性能调优 - 提升 iOS 界面的渲染性能</a></li>
<li><a href="http://chars.tech/pieces/2017/07/03/ios-corner-radius.html" target="_blank" rel="noopener">从 iOS 的图片圆角想到渲染 - Chars
</a></li>
<li><a href="https://www.jianshu.com/p/ca51c9d3575b" target="_blank" rel="noopener">离屏渲染优化详解：实例示范 + 性能测试</a></li>
<li><a href="http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/" target="_blank" rel="noopener">优化 UITableViewCell 高度计算的那些事 - sunnyxx</a></li>
<li><a href="http://www.cnblogs.com/ludashi/p/5895725.html" target="_blank" rel="noopener">iOS 开发之多种 Cell 高度自适应实现方案的 UI 流畅度分析 - 青玉伏案</a></li>
</ol>
</blockquote>
<h2 id="1-屏幕显示图像的原理"><a href="#1-屏幕显示图像的原理" class="headerlink" title="1. 屏幕显示图像的原理"></a>1. 屏幕显示图像的原理</h2><p>首先从过去的显像管显示器（CRT）原理说起。CRT 的电子枪按照上面方式，从上到下一行行扫描，扫描完成后显示器就呈现一帧画面，随后电子枪回到初始位置继续下一次扫描。</p>
<p>当电子枪换到新的一行，准备进行扫描时，显示器会发出一个<strong>水平同步信号</strong>（horizonal synchronization），简称 HSync；而当一帧画面绘制完成后，电子枪回复到原位，准备画下一帧前，显示器会发出一个<strong>垂直同步信号</strong>（vertical synchronization），简称 VSync。</p>
<p>显示器通常以固定频率进行刷新，这个刷新率就是<strong>垂直同步信号</strong>产生的频率。尽管液晶显示器（LCD）的成像原理和显像管显示器截然不同，但是由于历史原因，液晶显示器仍然需要按照一定的刷新频率向 GPU 获取新的图像用于显示。</p>
<p><img src="/img/img001.png" alt="image001"></p>
<p>通常来说，计算机系统中 CPU、GPU、显示器是以上面这种方式协同工作的。CPU 计算好显示内容提交到 GPU，GPU 渲染完成后将渲染结果放入帧缓冲区（FrameBuffer），随后视频控制器会按照<strong>垂直同步信号</strong>逐行读取帧缓冲区的数据，经过数模转换传递给显示器显示。</p>
<p>在最简单的情况下，帧缓冲区只有一个，这时帧缓冲区的读取和刷新都会有比较大的效率问题。为了解决效率问题，显示系统引入双缓冲机制，即同时使用<strong>帧缓冲区（frame buffer）</strong>和<strong>后备缓冲区（back buffer）</strong>。在这种情况下，GPU 会预先渲染好一帧放入一个缓冲区内，让视频控制器读取，当下一帧渲染好后，GPU 会直接把视频控制器的指针指向第二个缓冲器。如此一来效率会有很大的提升。</p>
<p>双缓冲虽然能解决效率问题，但会引入一个新的问题。当视频控制器还未读取完成时，即屏幕内容刚显示一半时，GPU 将新的一帧内容提交到帧缓冲区并把两个缓冲区进行交换后，视频控制器就会把新的一帧数据的下半段显示到屏幕上，造成画面撕裂现象，如下图：</p>
<p><img src="/img/img002.jpg" alt="image002"></p>
<p>为了解决这个问题，GPU 通常有一个机制叫做<strong>垂直同步</strong>（简写也是 V-Sync），当开启垂直同步后，GPU 会等待显示器的<strong>垂直同步信号</strong>发出后，才进行新的一帧渲染和缓冲区更新。这样能解决画面撕裂现象，也增加了画面流畅度，但需要消费更多的计算资源，也会带来部分延迟。</p>
<p>iOS 设备会始终使用双缓存，并开启垂直同步。而安卓设备直到 4.1 版本，Google 才开始引入这种机制，目前安卓系统是三缓存+垂直同步。</p>
<h2 id="2-卡顿产生的原因"><a href="#2-卡顿产生的原因" class="headerlink" title="2. 卡顿产生的原因"></a>2. 卡顿产生的原因</h2><p><img src="/img/img003.png" alt="image003"></p>
<p>在<strong>垂直同步信号</strong>到来后，系统图形服务会通过 CADisplayLink 等机制通知 App，App 主线程开始在 CPU 中计算显示内容，比如视图的创建、布局计算、图片解码、文本绘制等。随后 CPU 会将计算好的内容提交到 GPU 去，由 GPU 进行变换、合成、渲染。随后 GPU 会把渲染结果提交到帧缓冲区去，等待下一次<strong>垂直同步信号</strong>到来时显示到屏幕上。由于垂直同步的机制，如果在一个<strong>垂直同步信号</strong>时间内，CPU 或者 GPU 没有完成内容提交，则那一帧就会被丢弃，等待下一次机会再显示，而这时显示屏会保留之前的内容不变。这就是界面卡顿的原因。</p>
<p>从上图中可以看到，CPU 和 GPU 不论哪个阻碍了显示流程，都会造成掉帧现象。所以开发时，需要分别对 CPU 和 GPU 压力进行评估和优化。</p>
<h2 id="3-CPU-资源消耗原因和解决方案"><a href="#3-CPU-资源消耗原因和解决方案" class="headerlink" title="3. CPU 资源消耗原因和解决方案"></a>3. CPU 资源消耗原因和解决方案</h2><h3 id="对象创建"><a href="#对象创建" class="headerlink" title="对象创建"></a>对象创建</h3><p>对象的创建会分配内存、调整属性、甚至还有读取文件等操作，比较消耗 CPU 资源。</p>
<ol>
<li>尽量用轻量的对象代替重量的对象：比如 CALayer 比 UIView 要轻量许多，那么不需要响应触摸事件的控件，用 CALayer 显示会更加合适。</li>
<li>如果对象不涉及 UI 操作，则尽量放到后台线程去创建，但可惜的是包含有 CALayer 的控件，都只能在主线程创建和操作。</li>
<li>通过 Xib/Storyboard 创建视图对象时，其资源消耗会比直接通过代码创建对象要大非常多，在性能敏感的界面里不要使用。</li>
<li>如果对象可以复用，并且复用的代价比释放、创建新对象要小，那么这类对象应当尽量放到一个缓存池里复用。</li>
</ol>
<h3 id="对象调整"><a href="#对象调整" class="headerlink" title="对象调整"></a>对象调整</h3><p>对象的调整也经常是消耗 CPU 资源的地方，这里特别说一下 CALayer：CALayer 内部并没有属性，当调用属性方法时，它内部是通过 runtime 为对象临时添加一个方法，并把对应属性值保存到内部的一个 Dictionary 里，同时还会通知 delegate、创建动画等等，非常消耗资源。UIView 的关于显示相关的属性（比如 frame/bounds/transform）等实际上都是 CALayer 属性映射来的，所以对这些属性进行调整时，消耗的资源要远大于一般的属性。对此你在应用中，应该尽量减少不必要的属性修改。</p>
<h3 id="对象销毁"><a href="#对象销毁" class="headerlink" title="对象销毁"></a>对象销毁</h3><p>对象的销毁虽然消耗资源不多，但累积起来也是不容忽视的。同样的，如果对象可以放到后台线程去释放，那就挪到后台线程去。这里有个小 Tip：把对象捕获到 block 中，然后扔到后台队列去随便发送个消息以避免编译器警告，就可以让对象在后台线程销毁了。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *tmp = <span class="keyword">self</span>.array;</span><br><span class="line"><span class="keyword">self</span>.array = <span class="literal">nil</span>;</span><br><span class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</span><br><span class="line">    [tmp <span class="keyword">class</span>];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Autolayout"><a href="#Autolayout" class="headerlink" title="Autolayout"></a>Autolayout</h3><p>Autolayout 是苹果本身提倡的技术，但是对于复杂视图来说会产生严重的性能问题。随着视图数量的增长，Autolayout 带来的 CPU 消耗会呈指数级上升。具体数据可以看这个文章：<a href="http://pilky.me/36/" target="_blank" rel="noopener">http://pilky.me/36/</a>。</p>
<h3 id="文本计算"><a href="#文本计算" class="headerlink" title="文本计算"></a>文本计算</h3><p>如果一个界面中包含大量文本（比如微博微信朋友圈等），文本的宽高计算会占用很大一部分资源，并且不可避免。如果你对文本显示没有特殊要求，可以参考下 UILabel 内部的实现方式：用 <code>[string boundingRectWithSize:options:context:]</code> 来计算文本宽高，用 <code>[string drawWithRect:options:attributes:context:]</code> 来绘制文本。尽管这两个方法性能不错，但仍旧需要放到后台线程进行以避免阻塞主线程。</p>
<p>如果你用 CoreText 绘制文本，那就可以先生成 CoreText 排版对象，然后自己计算了，并且 CoreText 对象还能保留以供稍后绘制使用。</p>
<h3 id="文本渲染"><a href="#文本渲染" class="headerlink" title="文本渲染"></a>文本渲染</h3><p>屏幕上能看到的所有文本内容控件，包括 UIWebView，在底层都是通过 CoreText 排版、绘制为 Bitmap 显示的。常见的文本控件 （UILabel、UITextView 等），其排版和绘制都是在主线程进行的，当显示大量文本时，CPU 的压力会非常大。对此解决方案只有一个，那就是自定义文本控件，用 TextKit 或者最底层的 CoreText 对文本异步绘制。尽管这实现起来非常麻烦，但其带来的优势也非常大，CoreText 对象创建好后，能直接获取文本的宽高等信息，避免了多次计算（调整 UILabel 大小时算一遍、UILabel 绘制时内部再算一遍）。而且 CoreText 对象占用内存较少，可以缓存下来以备稍后多次渲染。</p>
<h3 id="图片的解码"><a href="#图片的解码" class="headerlink" title="图片的解码"></a>图片的解码</h3><p>当你用 UIImage 或 CGImageSource 的那几个方法创建图片时，图片数据并不会立刻解码。图片设置到 UIImageView 或者 CALayer.contents 中去，并且 CALayer 被提交到 GPU 前，CGImage 中的数据才会得到解码。这一步是发生在主线程的，并且不可避免。如果想要绕开这个机制，常见的做法是在后台线程先把图片绘制到 CGBitmapContext 中，然后从 Bitmap 直接创建图片。目前常见的网络图片库都自带这个功能。</p>
<h3 id="图像的绘制"><a href="#图像的绘制" class="headerlink" title="图像的绘制"></a>图像的绘制</h3><p>图像的绘制通常是指用那些以 CG 开头的方法把图像绘制到画布中，然后从画布创建图片并显示这样一个过程。这个最常见的地方就是 <code>[UIView drawRect:]</code> 里面了。由于 CoreGraphic 方法通常都是线程安全的，所以图像的绘制可以很容易的放到后台线程进行。一个简单异步绘制的过程大致如下（实际情况会比这个复杂得多，但原理基本一致）：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)display &#123;</span><br><span class="line">    <span class="built_in">dispatch_async</span>(backgroundQueue, ^&#123;</span><br><span class="line">        <span class="built_in">CGContextRef</span> ctx = <span class="built_in">CGBitmapContextCreate</span>(...);</span><br><span class="line">        <span class="comment">// draw in context...</span></span><br><span class="line">        <span class="built_in">CGImageRef</span> img = <span class="built_in">CGBitmapContextCreateImage</span>(ctx);</span><br><span class="line">        <span class="built_in">CFRelease</span>(ctx);</span><br><span class="line">        <span class="built_in">dispatch_async</span>(mainQueue, ^&#123;</span><br><span class="line">            layer.contents = img;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-GPU-资源消耗原因和解决方案"><a href="#4-GPU-资源消耗原因和解决方案" class="headerlink" title="4. GPU 资源消耗原因和解决方案"></a>4. GPU 资源消耗原因和解决方案</h2><p>相对于 CPU 来说，GPU 能干的事情比较单一：接收提交的纹理（Texture）和顶点描述（三角形），应用变换（transform）、混合并渲染，然后输出到屏幕上。通常你所能看到的内容，主要也就是纹理（图片）和形状（三角模拟的矢量图形）两类。</p>
<h3 id="纹理的渲染（图片和视图）"><a href="#纹理的渲染（图片和视图）" class="headerlink" title="纹理的渲染（图片和视图）"></a>纹理的渲染（图片和视图）</h3><p>所有的 Bitmap，包括图片、文本、栅格化的内容，最终都要由内存提交到显存，绑定为 GPU Texture（是一个对 GPU 只读的资源，其有着一些属性，宽度、高度、色彩通道数量等）。不论是提交到显存的过程，还是 GPU 调整和渲染 Texture 的过程，都要消耗不少 GPU 资源。当在较短时间显示大量图片时（比如 TableView 存在非常多的图片并且快速滑动时），CPU 占用率很低，GPU 占用非常高，界面仍然会掉帧。避免这种情况的方法只能是尽量减少在短时间内大量图片的显示，尽可能将多张图片合成为一张进行显示。</p>
<p>当图片过大，超过 GPU 的最大纹理尺寸时，图片需要先由 CPU 进行预处理，这对 CPU 和 GPU 都会带来额外的资源消耗。目前来说，iPhone 4S 以上机型，纹理尺寸上限都是 4096×4096，更详细的资料可以看这里：<a href="http://www.iosres.com" target="_blank" rel="noopener">iosres.com</a>。所以，尽量不要让图片和视图的大小超过这个值。</p>
<h3 id="视图的混合（opaque-属性）"><a href="#视图的混合（opaque-属性）" class="headerlink" title="视图的混合（opaque 属性）"></a>视图的混合（opaque 属性）</h3><p>当多个视图（或者说 CALayer）重叠在一起显示时，GPU 会首先把他们混合到一起。如果视图结构过于复杂，混合的过程也会消耗很多 GPU 资源。为了减轻这种情况的 GPU 消耗，应用应当尽量减少视图数量和层次，并在不透明的视图里标明 opaque 属性 YES 以避免无用的 Alpha 通道合成。当然，这也可以用上面的方法，把多个视图预先渲染为一张图片来显示。</p>
<blockquote>
<p>opaque 属性表示当前控件是否不透明，UIView 默认值是 YES，但 UIButton 等子类的默认值都是 NO。为了提升性能，如果开发中 UIView 是不透明的，opaque 设置为 YES，如果  Alpha 小于 1，则 opaque 应该设置为 NO。</p>
</blockquote>
<h3 id="图形的生成（离屏渲染）"><a href="#图形的生成（离屏渲染）" class="headerlink" title="图形的生成（离屏渲染）"></a>图形的生成（离屏渲染）</h3><h4 id="a-当前屏幕渲染与离屏渲染"><a href="#a-当前屏幕渲染与离屏渲染" class="headerlink" title="a. 当前屏幕渲染与离屏渲染"></a>a. 当前屏幕渲染与离屏渲染</h4><p>OpenGL 中 GPU 屏幕渲染有两种方式：</p>
<ul>
<li>On-Screen Rendering，当前屏幕渲染，指的是 GPU 的渲染操作是在当前用于显示的屏幕缓冲区中进行。</li>
<li>Off-Screen Rendering，离屏渲染，指的是 GPU 在当前屏幕缓冲区以外新开辟一个缓冲区进行渲染操作。</li>
</ul>
<p>相比于当前屏幕渲染，离屏渲染的代价是很高的。首先要创建一个新的缓冲区，然后需要多次切换上下文环境。其中创建新缓冲区代价并不算太大，付出代价最大的是上下文切换。</p>
<blockquote>
<p>上下文切换：不管是在 GPU 渲染过程中，还是一直所熟悉的进程切换，上下文切换在哪里都是一个相当耗时的操作。首先我要保存当前屏幕渲染环境，然后切换到一个新的绘制环境，申请绘制资源，初始化环境，然后开始一个绘制，绘制完毕后销毁这个绘制环境，切换到当前屏幕渲染或者再开始一个新的离屏渲染重复之前的操作。</p>
</blockquote>
<h4 id="b-离屏渲染触发方式"><a href="#b-离屏渲染触发方式" class="headerlink" title="b. 离屏渲染触发方式"></a>b. 离屏渲染触发方式</h4><ul>
<li>drawRect</li>
<li>layer.shouldRasterize = true;</li>
<li>layer.masksToBounds / layer.shadow<ul>
<li>shouldRasterize（光栅化）</li>
<li>masks（遮罩）</li>
<li>shadows（阴影）</li>
<li>edge antialiasing（抗锯齿）</li>
<li>group opacity（不透明）</li>
</ul>
</li>
<li>Text（UILabel, CATestLayer, Core Text…）</li>
</ul>
<p>其中 shouldRasterize（光栅化）是比较特别的一种，如果 <code>CALayer.shouldRasterize =  YES</code>，在其他属性触发离屏绘制的同时，会将光栅化后的内容缓存起来，如果对应的 layer 及其 sublayers 没有发生改变，在下一帧的时候可以直接复用。这样会隐式的创建一个位图，各种阴影遮罩等效果也会保存到位图中并缓存起来，相当于把 GPU 的操作转到 CPU 上了，生成位图缓存，直接读取复用，这将在很大程度上提升渲染性能。但是对于经常变动的内容，建议不要开启，否则会造成性能的浪费。比如 TableViewCell 重绘是很频繁的，因为复用，cell 需要不断的重绘，如果此时设置了 cell.layer 可光栅化，则会造成大量的离屏渲染，降低图形性能。</p>
<blockquote>
<p>光栅化：将图转化成一个个栅格组成的图像，每个元素对应帧缓冲区中的一个像素。</p>
</blockquote>
<p>对于圆角的优化，目前可以考虑三方面：</p>
<ul>
<li>第一，用一张已经绘制好的圆角图片覆盖到原本视图上面来模拟相同的视觉效果；</li>
<li>第二，将图片切割成指定圆角的样式；</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(<span class="keyword">self</span>.size, <span class="literal">NO</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">CGContextRef</span> context = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br><span class="line"><span class="built_in">CGRect</span> rect = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">self</span>.size.width, <span class="keyword">self</span>.size.height);</span><br><span class="line"><span class="built_in">CGContextScaleCTM</span>(context, <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line"><span class="built_in">CGContextTranslateCTM</span>(context, <span class="number">0</span>, -rect.size.height);</span><br><span class="line"></span><br><span class="line"><span class="built_in">CGFloat</span> minSize = MIN(<span class="keyword">self</span>.size.width, <span class="keyword">self</span>.size.height);</span><br><span class="line"><span class="keyword">if</span> (borderWidth &lt; minSize / <span class="number">2.0</span>) &#123;</span><br><span class="line">    <span class="built_in">UIBezierPath</span> *path = [<span class="built_in">UIBezierPath</span> bezierPathWithRoundedRect:<span class="built_in">CGRectInset</span>(rect, borderWidth, borderWidth) byRoundingCorners:corners cornerRadii:<span class="built_in">CGSizeMake</span>(radius, borderWidth)];</span><br><span class="line">    <span class="built_in">CGContextSaveGState</span>(context);</span><br><span class="line">    [path addClip];</span><br><span class="line">    <span class="built_in">CGContextDrawImage</span>(context, rect, <span class="keyword">self</span>.CGImage);</span><br><span class="line">    <span class="built_in">CGContextRestoreGState</span>(context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIImage</span> *image = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">image = [image dd_imageByCornerRadius:radius borderedColor:borderColor borderWidth:borderWidth corners:corners];</span><br><span class="line"><span class="built_in">UIGraphicsEndImageContext</span>();</span><br></pre></td></tr></table></figure>
<ul>
<li>第三，使用贝塞尔曲线，利用 CALayer 层绘制指定圆角样式的 mask 遮盖 View。</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(<span class="keyword">self</span>.size, <span class="literal">NO</span>, <span class="number">0</span>);</span><br><span class="line">[<span class="keyword">self</span> drawAtPoint:<span class="built_in">CGPointZero</span>];</span><br><span class="line"><span class="built_in">CGRect</span> rect = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">self</span>.size.width, <span class="keyword">self</span>.size.height);</span><br><span class="line"><span class="built_in">CGFloat</span> strokeInset = borderWidth / <span class="number">2.0</span>;</span><br><span class="line"><span class="built_in">CGRect</span> strokeRect = <span class="built_in">CGRectInset</span>(rect, strokeInset, strokeInset);</span><br><span class="line"><span class="built_in">UIBezierPath</span> *path = [<span class="built_in">UIBezierPath</span> bezierPathWithRoundedRect:strokeRect byRoundingCorners:corners cornerRadii:<span class="built_in">CGSizeMake</span>(radius, borderWidth)];</span><br><span class="line">path.lineWidth = borderWidth;</span><br><span class="line">[borderColor setStroke];</span><br><span class="line">[path stroke];</span><br><span class="line"><span class="built_in">UIImage</span> *result = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line"><span class="built_in">UIGraphicsEndImageContext</span>();</span><br></pre></td></tr></table></figure>
<h4 id="c-另一种特殊的离屏渲染：CPU-渲染"><a href="#c-另一种特殊的离屏渲染：CPU-渲染" class="headerlink" title="c. 另一种特殊的离屏渲染：CPU 渲染"></a>c. 另一种特殊的离屏渲染：CPU 渲染</h4><p>如果我们重写了 drawRect 方法，并且使用任何 Core Graphics 的技术进行了绘制操作，就涉及到了 CPU 渲染。整个渲染过程由 CPU 在 App 内同步地完成，渲染得到的 bitmap 最后再交由 GPU 用于显示。</p>
<p>由于 GPU 的浮点运算能力比 CPU 强，CPU 渲染的效率可能不如离屏渲染；但如果仅仅是实现一个简单的效果，直接使用 CPU 渲染的效率又可能比离屏渲染好，毕竟离屏渲染要涉及到缓冲区创建和上下文切换等耗时操作。</p>
<h4 id="d-离屏渲染检测工具：Instruments"><a href="#d-离屏渲染检测工具：Instruments" class="headerlink" title="d. 离屏渲染检测工具：Instruments"></a>d. 离屏渲染检测工具：Instruments</h4><p>Instruments 的 Core Animation 工具中有两个和离屏渲染相关的检查选项：</p>
<ol>
<li><p><strong>Color</strong> <strong>Offscreen-Rendered</strong> <strong>Yellow</strong><br>开启后会把那些需要离屏渲染的图层高亮成黄色，这就意味着黄色图层可能存在性能问题。</p>
</li>
<li><p><strong>Color</strong> <strong>Hits</strong> <strong>Green</strong> <strong>and</strong> <strong>Misses</strong> <strong>Red</strong><br>这一项是检查该场景下光栅化操作是否是一个好的选择，如果图层是绿色，就表示这些缓存被复用；如果是红色就表示缓存会被重复创建，这就表示该处存在性能问题了。</p>
</li>
</ol>
<h4 id="e-iOS-版本上的优化"><a href="#e-iOS-版本上的优化" class="headerlink" title="e. iOS 版本上的优化"></a>e. iOS 版本上的优化</h4><p>iOS 9.0 之前 UIimageView 跟 UIButton 设置圆角都会触发离屏渲染</p>
<p>iOS 9.0 之后 UIButton 设置圆角会触发离屏渲染，而 UIImageView 里 png 图片设置圆角不会触发离屏渲染了，如果设置其他阴影效果之类的还是会触发离屏渲染的。</p>
<p>这可能是苹果也意识到离屏渲染会产生性能问题，所以能不产生离屏渲染的地方苹果也就不用离屏渲染了。</p>
<h2 id="5-AsyncDisplayKit-思维方式"><a href="#5-AsyncDisplayKit-思维方式" class="headerlink" title="5. AsyncDisplayKit 思维方式"></a>5. AsyncDisplayKit 思维方式</h2><p>AsyncDisplayKit 是 Facebook 开源的一个用于保持 iOS 界面流畅的库，其作者是 Scott Goodson (<a href="https://www.linkedin.com/in/iosengineer" target="_blank" rel="noopener">Linkedin</a>)</p>
<h3 id="ASDK-基本原理"><a href="#ASDK-基本原理" class="headerlink" title="ASDK 基本原理"></a>ASDK 基本原理</h3><p><img src="/img/img004.png" alt="image004"></p>
<p>ASDK 认为，阻塞主线程的任务，主要分为上面这三大类。文本和布局的计算、渲染、解码、绘制都可以通过各种方式异步执行，但 UIKit 和 Core Animation 相关操作必需在主线程进行。ASDK 的目标，就是尽量把这些任务从主线程挪走，而挪不走的，就尽量优化性能。</p>
<p>常见的 UIView 和 CALayer 的关系：View 持有 Layer 用于显示，View 中大部分显示属性实际是从 Layer 映射而来；Layer 的 delegate 在这里是 View，当其属性改变、动画产生时，View 能够得到通知。UIView 和 CALayer 不是线程安全的，并且只能在主线程创建、访问和销毁。</p>
<p><img src="/img/img005.png" alt="image005"></p>
<p>ASDK 为此创建了 ASDisplayNode 类，包装了常见的视图属性（比如 frame/bounds/alpha/transform/backgroundColor/superNode/subNodes 等），然后它用 UIView -&gt; CALayer 相同的方式，实现了 ASNode -&gt; UIView 这样一个关系。</p>
<p><img src="/img/img006.png" alt="image006"></p>
<p>当不需要响应触摸事件时，ASDisplayNode 可以被设置为 layer backed，即 ASDisplayNode 充当了原来 UIView 的功能，节省了更多资源。</p>
<p>与 UIView 和 CALayer 不同，ASDisplayNode 是线程安全的，它可以在后台线程创建和修改。Node 刚创建时，并不会在内部新建 UIView 和 CALayer，直到第一次在主线程访问 view 或 layer 属性时，它才会在内部生成对应的对象。当它的属性（比如frame/transform）改变后，它并不会立刻同步到其持有的 view 或 layer 去，而是把被改变的属性保存到内部的一个中间变量，稍后在需要时，再通过某个机制一次性设置到内部的 view 或 layer。</p>
<p>通过模拟和封装 UIView/CALayer，开发者可以把代码中的 UIView 替换为 ASNode，很大的降低了开发和学习成本，同时能获得 ASDK 底层大量的性能优化。为了方便使用，ASDK 把大量常用控件都封装成了 ASNode 的子类，比如 Button、Control、Cell、Image、ImageView、Text、TableView、CollectionView 等。利用这些控件，开发者可以尽量避免直接使用 UIKit 相关控件，以获得更完整的性能提升。</p>
<h3 id="ASDK-的图层预合成"><a href="#ASDK-的图层预合成" class="headerlink" title="ASDK 的图层预合成"></a>ASDK 的图层预合成</h3><p><img src="/img/img007.png" alt="image007"><img src="/img/img008.png" alt="image008"></p>
<p>有时一个 layer 会包含很多 sub-layer，而这些 sub-layer 并不需要响应触摸事件，也不需要进行动画和位置调整。ASDK 为此实现了一个被称为 pre-composing 的技术，可以把这些 sub-layer 合成渲染为一张图片。开发时，ASNode 已经替代了 UIView 和 CALayer；直接使用各种 Node 控件并设置为 layer backed 后，ASNode 甚至可以通过预合成来避免创建内部的 UIView 和 CALayer。</p>
<p>通过这种方式，把一个大的层级，通过一个大的绘制方法绘制到一张图上，性能会获得很大提升。CPU 避免了创建 UIKit 对象的资源消耗，GPU 避免了多张 texture 合成和渲染的消耗，更少的 bitmap 也意味着更少的内存占用。</p>
<h3 id="ASDK-异步并发操作"><a href="#ASDK-异步并发操作" class="headerlink" title="ASDK 异步并发操作"></a>ASDK 异步并发操作</h3><p>充分利用多核的优势、并发执行任务对保持界面流畅有很大作用。ASDK 把布局计算、文本排版、图片/文本/图形渲染等操作都封装成较小的任务，并利用 GCD 异步并发执行。如果开发者使用了 ASNode 相关的控件，那么这些并发操作会自动在后台进行，无需进行过多配置。</p>
<h3 id="Runloop-任务分发"><a href="#Runloop-任务分发" class="headerlink" title="Runloop 任务分发"></a>Runloop 任务分发</h3><p><img src="/img/img009.png" alt="image009"></p>
<p>Runloop work distribution 是 ASDK 比较核心的一个技术，iOS 的显示系统是由<strong>垂直同步信号</strong>驱动的，<strong>垂直同步信号</strong>由硬件时钟生成，每秒钟发出 60 次（这个值取决设备硬件，比如 iPhone 真机上通常是 59.97）。iOS 图形服务接收到<strong>垂直同步信号</strong>后，会通过 IPC 通知到 App 内。App 的 Runloop 在启动后会注册对应的 CFRunLoopSource 接收传过来的时钟信号通知，随后 Source 的回调会驱动整个 App 的动画与显示。</p>
<p>Core Animation 在 RunLoop 中注册了一个 Observer，监听了 BeforeWaiting 和 Exit 事件。当一个触摸事件到来时，RunLoop 被唤醒，App 中的代码会执行一些操作，比如创建和调整视图层级、设置 UIView 的 frame、修改 CALayer 的透明度、为视图添加一个动画；这些操作最终都会被 CALayer 捕获，并通过 CATransaction 提交到一个中间状态去。当上面所有操作结束后，RunLoop 即将进入休眠（或者退出）时，关注该事件的 Observer 都会得到通知。这时 Core Animation 注册的那个 Observer 就会在回调中，把所有的中间状态合并提交到 GPU 去显示；如果此处有动画，CA 会通过 DisplayLink 等机制多次触发相关流程。</p>
<p>ASDK 在此处模拟了 Core Animation 的这个机制：所有针对 ASNode 的修改和提交，总有些任务是必需放入主线程执行的。当出现这种任务时，ASNode 会把任务用 ASAsyncTransaction(Group) 封装并提交到一个全局的容器去。ASDK 也在 RunLoop 中注册了一个 Observer，监视的事件和 Core Animation 一样，但优先级要低。当 RunLoop 进入休眠前、CA 处理完事件后，ASDK 就会执行该 loop 内提交的所有任务。</p>
<p>通过这种机制，ASDK 可以在合适的机会把异步、并发的操作同步到主线程去，并且能获得不错的性能。</p>
<h2 id="6-微博性能优化技巧"><a href="#6-微博性能优化技巧" class="headerlink" title="6. 微博性能优化技巧"></a>6. 微博性能优化技巧</h2><h3 id="预排版"><a href="#预排版" class="headerlink" title="预排版"></a>预排版</h3><p>当获取到 JSON 数据后，我会把每条 Cell 需要的数据都在后台线程计算并封装为一个布局对象 CellLayout。CellLayout 包含所有文本的 CoreText 排版结果、Cell 内部每个控件的高度、Cell 的整体高度。每个 CellLayout 的内存占用并不多，所以当生成后，可以全部缓存到内存，以供稍后使用。这样，TableView 在请求各个高度函数时，不会消耗任何多余计算量；当把 CellLayout 设置到 Cell 内部时，Cell 内部也不用再计算布局了。</p>
<p>如果你对性能的要求并不那么高，可以尝试用 TableView 的预估高度的功能，并把每个 Cell 高度缓存下来。这里有个来自百度知道团队的开源项目可以很方便的帮你实现这一点：<a href="https://github.com/forkingdog/UITableView-FDTemplateLayoutCell/" target="_blank" rel="noopener">FDTemplateLayoutCell</a>。</p>
<h3 id="预渲染"><a href="#预渲染" class="headerlink" title="预渲染"></a>预渲染</h3><p>微博的头像在某次改版中换成了圆形，当头像下载下来后，我会在后台线程将头像预先渲染为圆形并单独保存到一个 ImageCache 中去。</p>
<p>对于 TableView 来说，Cell 内容的离屏渲染会带来较大的 GPU 消耗。如果用 layer 的圆角属性，查看 Instument 时能够看到 GPU 已经满负荷运转，而 CPU 却比较清闲。为了避免离屏渲染，你应当尽量避免使用 layer 的 border、corner、shadow、mask 等技术，而尽量在后台线程预先绘制好对应内容。</p>
<h3 id="异步绘制"><a href="#异步绘制" class="headerlink" title="异步绘制"></a>异步绘制</h3><p>我只在显示文本的控件上用到了异步绘制的功能，但效果很不错。我参考 ASDK 的原理，实现了一个简单的异步绘制控件。这块代码我单独提取出来，放到了这里：<a href="https://github.com/ibireme/YYAsyncLayer" target="_blank" rel="noopener">YYAsyncLayer</a>。YYAsyncLayer 是 CALayer 的子类，当它需要显示内容（比如调用了 <code>[layer setNeedDisplay]</code>）时，它会向 delegate，也就是 UIView 请求一个异步绘制的任务。在异步绘制时，Layer 会传递一个 <code>BOOL(^isCancelled)()</code> 这样的 block，绘制代码可以随时调用该 block 判断绘制任务是否已经被取消。</p>
<p>当 TableView 快速滑动时，会有大量异步绘制任务提交到后台线程去执行。但是有时滑动速度过快时，绘制任务还没有完成就可能已经被取消了。如果这时仍然继续绘制，就会造成大量的 CPU 资源浪费，甚至阻塞线程并造成后续的绘制任务迟迟无法完成。我的做法是尽量快速、提前判断当前绘制任务是否已经被取消；在绘制每一行文本前，我都会调用 isCancelled() 来进行判断，保证被取消的任务能及时退出，不至于影响后续操作。</p>
<p>目前有些第三方微博客户端（比如 VVebo、墨客等），使用了一种方式来避免高速滑动时 Cell 的绘制过程，相关实现见这个项目：<a href="https://github.com/johnil/VVeboTableViewDemo" target="_blank" rel="noopener">VVeboTableViewDemo</a>。它的原理是，当滑动时，松开手指后，立刻计算出滑动停止时 Cell 的位置，并预先绘制那个位置附近的几个 Cell，而忽略当前滑动中的 Cell。这个方法比较有技巧性，并且对于滑动性能来说提升也很大，唯一的缺点就是快速滑动中会出现大量空白内容。如果你不想实现比较麻烦的异步绘制但又想保证滑动的流畅性，这个技巧是个不错的选择。</p>
<h3 id="全局并发控制"><a href="#全局并发控制" class="headerlink" title="全局并发控制"></a>全局并发控制</h3><p>当用<strong>并发队列</strong>来执行大量绘制任务时，偶尔会遇到这种问题：大量的任务提交到后台队列时，某些任务会因为某些原因（此处是 CGFont 锁）被锁住导致线程休眠，或者被阻塞，<strong>并发队列</strong>随后会创建新的线程来执行其他任务。当这种情况变多时，或者 App 中使用了大量<strong>并发队列</strong>来执行较多任务时，App 在同一时刻就会存在几十个线程同时运行、创建、销毁。CPU 是用时间片轮转来实现线程并发的，尽管<strong>并发队列</strong>能控制线程的优先级，但当大量线程同时创建运行销毁时，这些操作仍然会挤占掉主线程的 CPU 资源。ASDK 有个 Feed 列表的 Demo：<a href="https://github.com/facebookarchive/AsyncDisplayKit/tree/master/examples/SocialAppLayout" target="_blank" rel="noopener">SocialAppLayout</a>，当列表内 Cell 过多，并且非常快速的滑动时，界面仍然会出现少量卡顿，我谨慎的猜测可能与这个问题有关。</p>
<p>使用<strong>并发队列</strong>时不可避免会遇到这种问题，但使用<strong>串行队列</strong>又不能充分利用多核 CPU 的资源。我写了一个简单的工具 <a href="https://github.com/ibireme/YYDispatchQueuePool" target="_blank" rel="noopener">YYDispatchQueuePool</a>，为不同优先级创建和 CPU 数量相同的 <strong>串行队列</strong>，每次从 pool 中获取 queue 时，会轮询返回其中一个 queue。我把 App 内所有异步操作，包括图像解码、对象释放、异步绘制等，都按优先级不同放入了全局的<strong>并发队列</strong>中执行，这样尽量避免了过多线程导致的性能问题。</p>
<h3 id="更高效的异步图片加载"><a href="#更高效的异步图片加载" class="headerlink" title="更高效的异步图片加载"></a>更高效的异步图片加载</h3><p>SDWebImage 在这个 Demo 里仍然会产生少量性能问题，并且有些地方不能满足我的需求，所以我自己实现了一个性能更高的图片加载库。在显示简单的单张图片时，利用 UIView.layer.contents 就足够了，没必要使用 UIImageView 带来额外的资源消耗，为此我在 CALayer 上添加了 setImageWithURL 等方法。除此之外，我还把图片解码等操作通过 YYDispatchQueuePool 进行管理，控制了 App 总线程数量。</p>
<h3 id="其他可以改进的地方"><a href="#其他可以改进的地方" class="headerlink" title="其他可以改进的地方"></a>其他可以改进的地方</h3><p>上面这些优化做完后，微博 Demo 已经非常流畅了，但在我的设想中，仍然有一些进一步优化的技巧，但限于时间和精力我并没有实现，下面简单列一下：</p>
<ol>
<li><p>列表中有不少视觉元素并不需要触摸事件，这些元素可以用 ASDK 的图层合成技术预先绘制为一张图。</p>
</li>
<li><p>再进一步减少每个 Cell 内图层的数量，用 CALayer 替换掉 UIView。</p>
</li>
<li><p>目前每个 Cell 的类型都是相同的，但显示的内容却各部一样，比如有的 Cell 有图片，有的 Cell 里是卡片。把 Cell 按类型划分，进一步减少 Cell 内不必要的视图对象和操作，应该能有一些效果。</p>
</li>
<li><p>把需要放到主线程执行的任务划分为足够小的块，并通过 Runloop 来进行调度，在每个 Loop 里判断下一次 VSync 的时间，并在下次 VSync 到来前，把当前未执行完的任务延迟到下一个机会去。这个只是我的一个设想，并不一定能实现或起作用。</p>
</li>
</ol>
<h2 id="7-如何评测界面的流畅度"><a href="#7-如何评测界面的流畅度" class="headerlink" title="7. 如何评测界面的流畅度"></a>7. 如何评测界面的流畅度</h2><p>最后还是要提一下，“过早的优化是万恶之源”，在需求未定，性能问题不明显时，没必要尝试做优化，而要尽量正确的实现功能。</p>
<p>如果你需要一个明确的 FPS 指示器，可以尝试一下 <a href="https://github.com/kconner/KMCGeigerCounter" target="_blank" rel="noopener">KMCGeigerCounter</a>。对于 CPU 的卡顿，它可以通过内置的 CADisplayLink 检测出来；对于 GPU 带来的卡顿，它用了一个 1×1 的 SKView 来进行监视。这个项目有两个小问题：SKView 虽然能监视到 GPU 的卡顿，但引入 SKView 本身就会对 CPU/GPU 带来额外的一点的资源消耗；这个项目在 iOS 9 下有一些兼容问题，需要稍作调整。</p>
<p>我自己也写了个简单的 FPS 指示器：<a href="https://github.com/ibireme/YYText/blob/master/Demo/YYTextDemo/YYFPSLabel.m" target="_blank" rel="noopener">FPSLabel</a> 只有几十行代码，仅用到了 CADisplayLink 来监视 CPU 的卡顿问题。虽然不如上面这个工具完善，但日常使用没有太大问题。</p>
<p>最后，用 Instuments 的 GPU Driver 预设，能够实时查看到 CPU 和 GPU 的资源消耗。在这个预设内，你能查看到几乎所有与显示有关的数据，比如 Texture 数量、CA 提交的频率、GPU 消耗等，在定位界面卡顿的问题时，这是最好的工具。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/avatar.jpeg"
                alt="mayan" />
            
              <p class="site-author-name" itemprop="name">mayan</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/mayan29" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:18511560993@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">mayan</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://mayan29.disqus.com/count.js" async></script>
    

    

  




	





  














  





  

  

  

  
  

  

  

  

</body>
</html>
